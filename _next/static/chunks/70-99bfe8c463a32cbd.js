(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{8099:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(7117);function n(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function a(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function s(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function o(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function l(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function h(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function u(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function c(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function f(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),u(e/4294967296>>>0,t,r),u(e>>>0,t,r+4),t}function d(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),c(e>>>0,t,r),c(e/4294967296>>>0,t,r+4),t}t.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},t.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},t.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},t.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},t.writeUint16BE=n,t.writeInt16BE=n,t.writeUint16LE=a,t.writeInt16LE=a,t.readInt32BE=s,t.readUint32BE=o,t.readInt32LE=l,t.readUint32LE=h,t.writeUint32BE=u,t.writeInt32BE=u,t.writeUint32LE=c,t.writeInt32LE=c,t.readInt64BE=function(e,t){void 0===t&&(t=0);var r=s(e,t),i=s(e,t+4);return 4294967296*r+i-(i>>31)*4294967296},t.readUint64BE=function(e,t){return void 0===t&&(t=0),4294967296*o(e,t)+o(e,t+4)},t.readInt64LE=function(e,t){void 0===t&&(t=0);var r=l(e,t);return 4294967296*l(e,t+4)+r-(r>>31)*4294967296},t.readUint64LE=function(e,t){void 0===t&&(t=0);var r=h(e,t);return 4294967296*h(e,t+4)+r},t.writeUint64BE=f,t.writeInt64BE=f,t.writeUint64LE=d,t.writeInt64LE=d,t.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,a=e/8+r-1;a>=r;a--)i+=t[a]*n,n*=256;return i},t.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,a=r;a<r+e/8;a++)i+=t[a]*n,n*=256;return i},t.writeUintBE=function(e,t,r,n){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===n&&(n=0),e%8!=0)throw Error("writeUintBE supports only bitLengths divisible by 8");if(!i.isSafeInteger(t))throw Error("writeUintBE value must be an integer");for(var a=1,s=e/8+n-1;s>=n;s--)r[s]=t/a&255,a*=256;return r},t.writeUintLE=function(e,t,r,n){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===n&&(n=0),e%8!=0)throw Error("writeUintLE supports only bitLengths divisible by 8");if(!i.isSafeInteger(t))throw Error("writeUintLE value must be an integer");for(var a=1,s=n;s<n+e/8;s++)r[s]=t/a&255,a*=256;return r},t.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},t.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},t.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},t.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},t.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},t.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},t.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},t.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t}},5439:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(8099),n=r(7309);function a(e,t,r,a,s){if(void 0===s&&(s=0),32!==e.length)throw Error("ChaCha: key size must be 32 bytes");if(a.length<r.length)throw Error("ChaCha: destination is shorter than source");if(0===s){if(8!==t.length&&12!==t.length)throw Error("ChaCha nonce must be 8 or 12 bytes");l=(o=new Uint8Array(16)).length-t.length,o.set(t,l)}else{if(16!==t.length)throw Error("ChaCha nonce with counter must be 16 bytes");o=t,l=s}for(var o,l,h=new Uint8Array(64),u=0;u<r.length;u+=64){!function(e,t,r){for(var n=r[3]<<24|r[2]<<16|r[1]<<8|r[0],a=r[7]<<24|r[6]<<16|r[5]<<8|r[4],s=r[11]<<24|r[10]<<16|r[9]<<8|r[8],o=r[15]<<24|r[14]<<16|r[13]<<8|r[12],l=r[19]<<24|r[18]<<16|r[17]<<8|r[16],h=r[23]<<24|r[22]<<16|r[21]<<8|r[20],u=r[27]<<24|r[26]<<16|r[25]<<8|r[24],c=r[31]<<24|r[30]<<16|r[29]<<8|r[28],f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],d=t[7]<<24|t[6]<<16|t[5]<<8|t[4],y=t[11]<<24|t[10]<<16|t[9]<<8|t[8],p=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=1634760805,b=857760878,g=2036477234,m=1797285236,v=n,E=a,A=s,_=o,S=l,P=h,k=u,x=c,K=f,H=d,U=y,B=p,I=0;I<20;I+=2)K^=w=w+v|0,v^=S=S+(K=K>>>16|K<<16)|0,v=v>>>20|v<<12,H^=b=b+E|0,E^=P=P+(H=H>>>16|H<<16)|0,E=E>>>20|E<<12,U^=g=g+A|0,A^=k=k+(U=U>>>16|U<<16)|0,A=A>>>20|A<<12,B^=m=m+_|0,_^=x=x+(B=B>>>16|B<<16)|0,_=_>>>20|_<<12,U^=g=g+A|0,A^=k=k+(U=U>>>24|U<<8)|0,A=A>>>25|A<<7,B^=m=m+_|0,_^=x=x+(B=B>>>24|B<<8)|0,_=_>>>25|_<<7,H^=b=b+E|0,E^=P=P+(H=H>>>24|H<<8)|0,E=E>>>25|E<<7,K^=w=w+v|0,v^=S=S+(K=K>>>24|K<<8)|0,v=v>>>25|v<<7,B^=w=w+E|0,E^=k=k+(B=B>>>16|B<<16)|0,E=E>>>20|E<<12,K^=b=b+A|0,A^=x=x+(K=K>>>16|K<<16)|0,A=A>>>20|A<<12,H^=g=g+_|0,_^=S=S+(H=H>>>16|H<<16)|0,_=_>>>20|_<<12,U^=m=m+v|0,v^=P=P+(U=U>>>16|U<<16)|0,v=v>>>20|v<<12,H^=g=g+_|0,_^=S=S+(H=H>>>24|H<<8)|0,_=_>>>25|_<<7,U^=m=m+v|0,v^=P=P+(U=U>>>24|U<<8)|0,v=v>>>25|v<<7,K^=b=b+A|0,A^=x=x+(K=K>>>24|K<<8)|0,A=A>>>25|A<<7,B^=w=w+E|0,E^=k=k+(B=B>>>24|B<<8)|0,E=E>>>25|E<<7;i.writeUint32LE(w+1634760805|0,e,0),i.writeUint32LE(b+857760878|0,e,4),i.writeUint32LE(g+2036477234|0,e,8),i.writeUint32LE(m+1797285236|0,e,12),i.writeUint32LE(v+n|0,e,16),i.writeUint32LE(E+a|0,e,20),i.writeUint32LE(A+s|0,e,24),i.writeUint32LE(_+o|0,e,28),i.writeUint32LE(S+l|0,e,32),i.writeUint32LE(P+h|0,e,36),i.writeUint32LE(k+u|0,e,40),i.writeUint32LE(x+c|0,e,44),i.writeUint32LE(K+f|0,e,48),i.writeUint32LE(H+d|0,e,52),i.writeUint32LE(U+y|0,e,56),i.writeUint32LE(B+p|0,e,60)}(h,o,e);for(var c=u;c<u+64&&c<r.length;c++)a[c]=r[c]^h[c-u];!function(e,t,r){for(var i=1;r--;)i=i+(255&e[t])|0,e[t]=255&i,i>>>=8,t++;if(i>0)throw Error("ChaCha: counter overflow")}(o,0,l)}return n.wipe(h),0===s&&n.wipe(o),a}t.streamXOR=a,t.stream=function(e,t,r,i){return void 0===i&&(i=0),n.wipe(r),a(e,t,r,r,i)}},5501:function(e,t,r){"use strict";var i=r(5439),n=r(3027),a=r(7309),s=r(8099),o=r(4153);t.Cv=32,t.WH=12,t.pg=16;var l=new Uint8Array(16),h=function(){function e(e){if(this.nonceLength=t.WH,this.tagLength=t.pg,e.length!==t.Cv)throw Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,r,n){if(e.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");var s,o=new Uint8Array(16);o.set(e,o.length-e.length);var l=new Uint8Array(32);i.stream(this._key,o,l,4);var h=t.length+this.tagLength;if(n){if(n.length!==h)throw Error("ChaCha20Poly1305: incorrect destination length");s=n}else s=new Uint8Array(h);return i.streamXOR(this._key,o,t,s,4),this._authenticate(s.subarray(s.length-this.tagLength,s.length),l,s.subarray(0,s.length-this.tagLength),r),a.wipe(o),s},e.prototype.open=function(e,t,r,n){if(e.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s,l=new Uint8Array(16);l.set(e,l.length-e.length);var h=new Uint8Array(32);i.stream(this._key,l,h,4);var u=new Uint8Array(this.tagLength);if(this._authenticate(u,h,t.subarray(0,t.length-this.tagLength),r),!o.equal(u,t.subarray(t.length-this.tagLength,t.length)))return null;var c=t.length-this.tagLength;if(n){if(n.length!==c)throw Error("ChaCha20Poly1305: incorrect destination length");s=n}else s=new Uint8Array(c);return i.streamXOR(this._key,l,t.subarray(0,t.length-this.tagLength),s,4),a.wipe(l),s},e.prototype.clean=function(){return a.wipe(this._key),this},e.prototype._authenticate=function(e,t,r,i){var o=new n.Poly1305(t);i&&(o.update(i),i.length%16>0&&o.update(l.subarray(i.length%16))),o.update(r),r.length%16>0&&o.update(l.subarray(r.length%16));var h=new Uint8Array(8);i&&s.writeUint64LE(i.length,h),o.update(h),s.writeUint64LE(r.length,h),o.update(h);for(var u=o.digest(),c=0;c<u.length;c++)e[c]=u[c];o.clean(),a.wipe(u),a.wipe(h)},e}();t.OK=h},4153:function(e,t){"use strict";function r(e,t){if(e.length!==t.length)return 0;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 1&r-1>>>8}Object.defineProperty(t,"__esModule",{value:!0}),t.select=function(e,t,r){return~(e-1)&t|e-1&r},t.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},t.compare=r,t.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==r(e,t)}},7117:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mul=Math.imul||function(e,t){var r=65535&e,i=65535&t;return r*i+((e>>>16&65535)*i+r*(t>>>16&65535)<<16>>>0)|0},t.add=function(e,t){return e+t|0},t.sub=function(e,t){return e-t|0},t.rotl=function(e,t){return e<<t|e>>>32-t},t.rotr=function(e,t){return e<<32-t|e>>>t},t.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(e){return t.isInteger(e)&&e>=-t.MAX_SAFE_INTEGER&&e<=t.MAX_SAFE_INTEGER}},3027:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(4153),n=r(7309);t.DIGEST_LENGTH=16;var a=function(){function e(e){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=e[0]|e[1]<<8;this._r[0]=8191&r;var i=e[2]|e[3]<<8;this._r[1]=(r>>>13|i<<3)&8191;var n=e[4]|e[5]<<8;this._r[2]=(i>>>10|n<<6)&7939;var a=e[6]|e[7]<<8;this._r[3]=(n>>>7|a<<9)&8191;var s=e[8]|e[9]<<8;this._r[4]=(a>>>4|s<<12)&255,this._r[5]=s>>>1&8190;var o=e[10]|e[11]<<8;this._r[6]=(s>>>14|o<<2)&8191;var l=e[12]|e[13]<<8;this._r[7]=(o>>>11|l<<5)&8065;var h=e[14]|e[15]<<8;this._r[8]=(l>>>8|h<<8)&8191,this._r[9]=h>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,r){for(var i=this._fin?0:2048,n=this._h[0],a=this._h[1],s=this._h[2],o=this._h[3],l=this._h[4],h=this._h[5],u=this._h[6],c=this._h[7],f=this._h[8],d=this._h[9],y=this._r[0],p=this._r[1],w=this._r[2],b=this._r[3],g=this._r[4],m=this._r[5],v=this._r[6],E=this._r[7],A=this._r[8],_=this._r[9];r>=16;){var S,P=e[t+0]|e[t+1]<<8;n+=8191&P;var k=e[t+2]|e[t+3]<<8;a+=(P>>>13|k<<3)&8191;var x=e[t+4]|e[t+5]<<8;s+=(k>>>10|x<<6)&8191;var K=e[t+6]|e[t+7]<<8;o+=(x>>>7|K<<9)&8191;var H=e[t+8]|e[t+9]<<8;l+=(K>>>4|H<<12)&8191,h+=H>>>1&8191;var U=e[t+10]|e[t+11]<<8;u+=(H>>>14|U<<2)&8191;var B=e[t+12]|e[t+13]<<8;c+=(U>>>11|B<<5)&8191;var I=e[t+14]|e[t+15]<<8;f+=(B>>>8|I<<8)&8191,d+=I>>>5|i;var O=0;O=(S=0+n*y+a*(5*_)+s*(5*A)+o*(5*E)+l*(5*v))>>>13,S&=8191,S+=h*(5*m)+u*(5*g)+c*(5*b)+f*(5*w)+d*(5*p),O+=S>>>13,S&=8191;var C=O;C+=n*p+a*y+s*(5*_)+o*(5*A)+l*(5*E),O=C>>>13,C&=8191,C+=h*(5*v)+u*(5*m)+c*(5*g)+f*(5*b)+d*(5*w),O+=C>>>13,C&=8191;var L=O;L+=n*w+a*p+s*y+o*(5*_)+l*(5*A),O=L>>>13,L&=8191,L+=h*(5*E)+u*(5*v)+c*(5*m)+f*(5*g)+d*(5*b),O+=L>>>13,L&=8191;var R=O;R+=n*b+a*w+s*p+o*y+l*(5*_),O=R>>>13,R&=8191,R+=h*(5*A)+u*(5*E)+c*(5*v)+f*(5*m)+d*(5*g),O+=R>>>13,R&=8191;var D=O;D+=n*g+a*b+s*w+o*p+l*y,O=D>>>13,D&=8191,D+=h*(5*_)+u*(5*A)+c*(5*E)+f*(5*v)+d*(5*m),O+=D>>>13,D&=8191;var j=O;j+=n*m+a*g+s*b+o*w+l*p,O=j>>>13,j&=8191,j+=h*y+u*(5*_)+c*(5*A)+f*(5*E)+d*(5*v),O+=j>>>13,j&=8191;var z=O;z+=n*v+a*m+s*g+o*b+l*w,O=z>>>13,z&=8191,z+=h*p+u*y+c*(5*_)+f*(5*A)+d*(5*E),O+=z>>>13,z&=8191;var T=O;T+=n*E+a*v+s*m+o*g+l*b,O=T>>>13,T&=8191,T+=h*w+u*p+c*y+f*(5*_)+d*(5*A),O+=T>>>13,T&=8191;var W=O;W+=n*A+a*E+s*v+o*m+l*g,O=W>>>13,W&=8191,W+=h*b+u*w+c*p+f*y+d*(5*_),O+=W>>>13,W&=8191;var N=O;N+=n*_+a*A+s*E+o*v+l*m,O=N>>>13,N&=8191,N+=h*g+u*b+c*w+f*p+d*y,O+=N>>>13,N&=8191,S=8191&(O=(O=(O<<2)+O|0)+S|0),O>>>=13,C+=O,n=S,a=C,s=L,o=R,l=D,h=j,u=z,c=T,f=W,d=N,t+=16,r-=16}this._h[0]=n,this._h[1]=a,this._h[2]=s,this._h[3]=o,this._h[4]=l,this._h[5]=h,this._h[6]=u,this._h[7]=c,this._h[8]=f,this._h[9]=d},e.prototype.finish=function(e,t){void 0===t&&(t=0);var r,i,n,a,s=new Uint16Array(10);if(this._leftover){for(a=this._leftover,this._buffer[a++]=1;a<16;a++)this._buffer[a]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,a=2;a<10;a++)this._h[a]+=r,r=this._h[a]>>>13,this._h[a]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,s[0]=this._h[0]+5,r=s[0]>>>13,s[0]&=8191,a=1;a<10;a++)s[a]=this._h[a]+r,r=s[a]>>>13,s[a]&=8191;for(s[9]-=8192,i=(1^r)-1,a=0;a<10;a++)s[a]&=i;for(a=0,i=~i;a<10;a++)this._h[a]=this._h[a]&i|s[a];for(a=1,this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,n=this._h[0]+this._pad[0],this._h[0]=65535&n;a<8;a++)n=(this._h[a]+this._pad[a]|0)+(n>>>16)|0,this._h[a]=65535&n;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,r=0,i=e.length;if(this._leftover){(t=16-this._leftover)>i&&(t=i);for(var n=0;n<t;n++)this._buffer[this._leftover+n]=e[r+n];if(i-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(t=i-i%16,this._blocks(e,r,t),r+=t,i-=t),i){for(var n=0;n<i;n++)this._buffer[this._leftover+n]=e[r+n];this._leftover+=i}return this},e.prototype.digest=function(){if(this._finished)throw Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return n.wipe(this._buffer),n.wipe(this._r),n.wipe(this._h),n.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();t.Poly1305=a,t.oneTimeAuth=function(e,t){var r=new a(e);r.update(t);var i=r.digest();return r.clean(),i},t.equal=function(e,r){return e.length===t.DIGEST_LENGTH&&r.length===t.DIGEST_LENGTH&&i.equal(e,r)}},7309:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e}},5677:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){let r=a.default,n={loading:e=>{let{error:t,isLoading:r,pastDelay:i}=e;return null}};e instanceof Promise?n.loader=()=>e:"function"==typeof e?n.loader=e:"object"==typeof e&&(n=i({},n,e)),n=i({},n,t);let l=n.loader,h=()=>null!=l?l().then(s):Promise.resolve(s(()=>null));return(n.loadableGenerated&&(n=i({},n,n.loadableGenerated),delete n.loadableGenerated),"boolean"!=typeof n.ssr||n.ssr)?r(i({},n,{loader:h})):(delete n.webpack,delete n.modules,o(r,n))},t.noSSR=o;var i=r(6495).Z,n=r(2648).Z,a=(n(r(7294)),n(r(8976)));function s(e){return{default:(null==e?void 0:e.default)||e}}function o(e,t){return delete t.webpack,delete t.modules,e(t)}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2254:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LoadableContext=void 0;var i=(0,r(2648).Z)(r(7294));let n=i.default.createContext(null);t.LoadableContext=n},8976:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(6495).Z,n=(0,r(2648).Z)(r(7294)),a=r(2254);let s=[],o=[],l=!1;function h(e){let t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then(e=>(r.loading=!1,r.loaded=e,e)).catch(e=>{throw r.loading=!1,r.error=e,e}),r}class u{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state=i({},this._state,{error:this._res.error,loaded:this._res.loaded,loading:this._res.loading},e),this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function c(e){return function(e,t){let r=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),i=null;function s(){if(!i){let t=new u(e,r);i={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return i.promise()}if(!l){let e=r.webpack?r.webpack():r.modules;e&&o.push(t=>{for(let r of e)if(-1!==t.indexOf(r))return s()})}function h(e,t){!function(){s();let e=n.default.useContext(a.LoadableContext);e&&Array.isArray(r.modules)&&r.modules.forEach(t=>{e(t)})}();let o=n.default.useSyncExternalStore(i.subscribe,i.getCurrentValue,i.getCurrentValue);return n.default.useImperativeHandle(t,()=>({retry:i.retry}),[]),n.default.useMemo(()=>{var t;return o.loading||o.error?n.default.createElement(r.loading,{isLoading:o.loading,pastDelay:o.pastDelay,timedOut:o.timedOut,error:o.error,retry:i.retry}):o.loaded?n.default.createElement((t=o.loaded)&&t.default?t.default:t,e):null},[e,o])}return h.preload=()=>s(),h.displayName="LoadableComponent",n.default.forwardRef(h)}(h,e)}function f(e,t){let r=[];for(;e.length;){let i=e.pop();r.push(i(t))}return Promise.all(r).then(()=>{if(e.length)return f(e,t)})}c.preloadAll=()=>new Promise((e,t)=>{f(s).then(e,t)}),c.preloadReady=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(t=>{let r=()=>(l=!0,t());f(o,e).then(r,r)})},window.__NEXT_PRELOADREADY=c.preloadReady,t.default=c},4438:function(e){e.exports={style:{fontFamily:"'__Inter_e7970e', '__Inter_Fallback_e7970e'",fontStyle:"normal"},className:"__className_e7970e"}},5152:function(e,t,r){e.exports=r(5677)},1163:function(e,t,r){e.exports=r(6885)},2093:function(e,t,r){"use strict";let i,n;r.d(t,{Hu:function(){return eo},vN:function(){return iO},i5:function(){return es},q9:function(){return ea}});class a extends Error{constructor(e){super(e instanceof Error?e.message:"string"==typeof e?e:""),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,""===this.message?this.message=this.name:this.message=this.name+": "+this.message}}class s extends a{}class o extends a{}class l extends a{}class h extends a{}class u extends a{}class c extends a{}class f extends a{}class d extends a{}class y extends a{}class p extends a{}class w extends a{}(ee=en||(en={}))[ee.Base=0]="Base",ee[ee.Psk=1]="Psk",ee[ee.Auth=2]="Auth",ee[ee.AuthPsk=3]="AuthPsk",(et=ea||(ea={}))[et.DhkemP256HkdfSha256=16]="DhkemP256HkdfSha256",et[et.DhkemP384HkdfSha384=17]="DhkemP384HkdfSha384",et[et.DhkemP521HkdfSha512=18]="DhkemP521HkdfSha512",et[et.DhkemSecp256K1HkdfSha256=19]="DhkemSecp256K1HkdfSha256",et[et.DhkemX25519HkdfSha256=32]="DhkemX25519HkdfSha256",et[et.DhkemX448HkdfSha512=33]="DhkemX448HkdfSha512",(er=es||(es={}))[er.HkdfSha256=1]="HkdfSha256",er[er.HkdfSha384=2]="HkdfSha384",er[er.HkdfSha512=3]="HkdfSha512",(ei=eo||(eo={}))[ei.Aes128Gcm=1]="Aes128Gcm",ei[ei.Aes256Gcm=2]="Aes256Gcm",ei[ei.Chacha20Poly1305=3]="Chacha20Poly1305",ei[ei.ExportOnly=65535]="ExportOnly";let b=(Y=globalThis,Q={},new Proxy(Y,{get:(e,t,r)=>t in Q?Q[t]:Y[t],set:(e,t,r)=>(t in Q&&delete Q[t],Y[t]=r,!0),deleteProperty(e,t){let r=!1;return t in Q&&(delete Q[t],r=!0),t in Y&&(delete Y[t],r=!0),r},ownKeys(e){let t=Reflect.ownKeys(Y),r=Reflect.ownKeys(Q),i=new Set(r);return[...t.filter(e=>!i.has(e)),...r]},defineProperty:(e,t,r)=>(t in Q&&delete Q[t],Reflect.defineProperty(Y,t,r),!0),getOwnPropertyDescriptor:(e,t)=>t in Q?Reflect.getOwnPropertyDescriptor(Q,t):Reflect.getOwnPropertyDescriptor(Y,t),has:(e,t)=>t in Q||t in Y})),g=()=>void 0!==b,m=()=>"undefined"!=typeof caches,v=e=>"object"==typeof e&&null!==e&&"object"==typeof e.privateKey&&"object"==typeof e.publicKey;function E(e,t){if(t<=0)throw Error("i2Osp: too small size");if(e>=256**t)throw Error("i2Osp: too large integer");let r=new Uint8Array(t);for(let i=0;i<t&&e;i++)r[t-(i+1)]=e%256,e>>=8;return r}function A(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}class _{constructor(e){Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._api=e}}async function S(){if((g()||m())&&void 0!==globalThis.crypto)return globalThis.crypto.subtle;try{let{webcrypto:e}=await Promise.all([r.e(714),r.e(681),r.e(866)]).then(r.t.bind(r,2474,19));return e.subtle}catch(e){throw new w("Web Cryptograph API not supported")}}let P=["deriveBits"],k=["encrypt","decrypt"],x=new Uint8Array(0),K=new Uint8Array([72,80,75,69,45,118,49]),H=new Uint8Array([72,80,75,69,0,0,0,0,0,0]),U=new Uint8Array([75,69,77,0,0]),B=new Uint8Array([100,107,112,95,112,114,107]),I=new Uint8Array([101,97,101,95,112,114,107]),O=new Uint8Array([105,110,102,111,95,104,97,115,104]),C=new Uint8Array([112,115,107,95,105,100,95,104,97,115,104]),L=new Uint8Array([115,101,99,114,101,116]),R=new Uint8Array([115,104,97,114,101,100,95,115,101,99,114,101,116]),D=new Uint8Array([107,101,121]),j=new Uint8Array([98,97,115,101,95,110,111,110,99,101]),z=new Uint8Array([101,120,112]),T=new Uint8Array([115,101,99]),W=new Uint8Array([99,97,110,100,105,100,97,116,101]),N=new Uint8Array([115,107]),$=new Uint8Array([255,255,255,255,0,0,0,0,255,255,255,255,255,255,255,255,188,230,250,173,167,23,158,132,243,185,202,194,252,99,37,81]),M=new Uint8Array([255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,199,99,77,129,244,55,45,223,88,26,13,178,72,176,167,122,236,236,25,106,204,197,41,115]),G=new Uint8Array([1,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,250,81,134,135,131,191,47,150,107,127,204,1,72,247,9,165,208,59,181,201,184,137,156,71,174,187,111,183,30,145,56,100,9]);class F extends _{constructor(e,t,r){super(e),Object.defineProperty(this,"exporterSecret",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._kdf=t,this.exporterSecret=r}async seal(e,t){return await this._emitError1()}async open(e,t){return await this._emitError1()}async setupBidirectional(e,t){return await this._emitError2()}async export(e,t){if(e.byteLength>128)throw new s("Too long exporter context");try{return await this._kdf.labeledExpand(this.exporterSecret,T,new Uint8Array(e),t)}catch(e){throw new c(e)}}_emitError1(){return new Promise((e,t)=>{t(new w("Not available on export-only mode"))})}_emitError2(){return new Promise((e,t)=>{t(new w("Not available on export-only mode"))})}}class q extends F{}class J extends F{constructor(e,t,r,i){super(e,t,r),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i;return}}class Z{constructor(e,t){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:eo.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_rawKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._rawKey=e,this._api=t}async seal(e,t,r){void 0===this._key&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i=await this._api.encrypt({name:"AES-GCM",iv:e,additionalData:r},this._key,t);return i}async open(e,t,r){void 0===this._key&&(this._key=await this.importKey(this._rawKey),new Uint8Array(this._rawKey).fill(0));let i=await this._api.decrypt({name:"AES-GCM",iv:e,additionalData:r},this._key,t);return i}async importKey(e){return await this._api.importKey("raw",e,{name:"AES-GCM"},!0,k)}}class V extends Z{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:eo.Aes128Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}}class X extends Z{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:eo.Aes256Gcm}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16})}}var Y,Q,ee,et,er,ei,en,ea,es,eo,el=r(5501);class eh{constructor(e){Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:eo.Chacha20Poly1305}),Object.defineProperty(this,"keySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"nonceSize",{enumerable:!0,configurable:!0,writable:!0,value:12}),Object.defineProperty(this,"tagSize",{enumerable:!0,configurable:!0,writable:!0,value:16}),Object.defineProperty(this,"_key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._key=new el.OK(new Uint8Array(e))}async seal(e,t,r){return await this._seal(e,t,r)}async open(e,t,r){return await this._open(e,t,r)}_seal(e,t,r){return new Promise(i=>{let n=this._key.seal(new Uint8Array(e),new Uint8Array(t),new Uint8Array(r));i(n.buffer)})}_open(e,t,r){return new Promise((i,n)=>{let a=this._key.open(new Uint8Array(e),new Uint8Array(t),new Uint8Array(r));a instanceof Uint8Array?i(a.buffer):n(Error("failed to open."))})}}class eu extends F{constructor(e,t,r){if(super(e,t,r.exporterSecret),Object.defineProperty(this,"_aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nT",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_f",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_r",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),void 0===r.key||void 0===r.baseNonce||void 0===r.seq)throw Error("Required parameters are missing");switch(this._aead=r.aead,this._aead){case eo.Aes128Gcm:this._nK=16,this._nN=12,this._nT=16;break;case eo.Aes256Gcm:case eo.Chacha20Poly1305:this._nK=32,this._nN=12,this._nT=16;break;default:this._nK=0,this._nN=0,this._nT=0}let i=ec(this._aead,r.key,this._api);this._f={key:i,baseNonce:r.baseNonce,seq:r.seq},this._r={key:i,baseNonce:x,seq:0}}computeNonce(e){let t=E(e.seq,e.baseNonce.byteLength);return function(e,t){if(e.byteLength!==t.byteLength)throw Error("xor: different length inputs");let r=new Uint8Array(e.byteLength);for(let i=0;i<e.byteLength;i++)r[i]=e[i]^t[i];return r}(e.baseNonce,t)}incrementSeq(e){if(e.seq>Number.MAX_SAFE_INTEGER)throw new y("Message limit reached");e.seq+=1}async setupBidirectional(e,t){try{this._r.baseNonce=new Uint8Array(await this.export(t,this._nN));let r=await this.export(e,this._nK);this._r.key=ec(this._aead,r,this._api),this._r.seq=0}catch(e){throw this._r.baseNonce=x,e}}}function ec(e,t,r){switch(e){case eo.Aes128Gcm:return new V(t,r);case eo.Aes256Gcm:return new X(t,r);case eo.Chacha20Poly1305:return new eh(t);default:throw Error("Invalid or unsupported AEAD id")}}function ef(e){if(!Number.isSafeInteger(e)||e<0)throw Error(`Wrong positive integer: ${e}`)}function ed(e,...t){if(!(e instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw TypeError(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}var ey={number:ef,bool:function(e){if("boolean"!=typeof e)throw Error(`Expected boolean, not ${e}`)},bytes:ed,hash:function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");ef(e.outputLen),ef(e.blockLen)},exists:function(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")},output:function(e,t){ed(e);let r=t.outputLen;if(e.length<r)throw Error(`digestInto() expects output buffer of length at least ${r}`)}};let ep={node:void 0,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},ew=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),eb=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),eg=(e,t)=>e<<32-t|e>>>t,em=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];if(!em)throw Error("Non little-endian hardware is not supported");function ev(e){if("string"!=typeof e)throw TypeError(`utf8ToBytes expected string, got ${typeof e}`);return new TextEncoder().encode(e)}function eE(e){if("string"==typeof e&&(e=ev(e)),!(e instanceof Uint8Array))throw TypeError(`Expected input type is Uint8Array (got ${typeof e})`);return e}function eA(...e){if(!e.every(e=>e instanceof Uint8Array))throw Error("Uint8Array list expected");if(1===e.length)return e[0];let t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));class e_{clone(){return this._cloneInto()}}function eS(e){let t=t=>e().update(eE(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function eP(e=32){if(ep.web)return ep.web.getRandomValues(new Uint8Array(e));if(ep.node)return new Uint8Array(ep.node.randomBytes(e).buffer);throw Error("The environment doesn't have randomBytes function")}class ek extends e_{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ey.hash(e);let r=eE(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw TypeError("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,n=new Uint8Array(i);n.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<n.length;e++)n[e]^=54;this.iHash.update(n),this.oHash=e.create();for(let e=0;e<n.length;e++)n[e]^=106;this.oHash.update(n),n.fill(0)}update(e){return ey.exists(this),this.iHash.update(e),this}digestInto(e){ey.exists(this),ey.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:n,blockLen:a,outputLen:s}=this;return e.finished=i,e.destroyed=n,e.blockLen=a,e.outputLen=s,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let ex=(e,t,r)=>new ek(e,t).update(r).digest();ex.create=(e,t)=>new ek(e,t);class eK extends e_{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=eb(this.buffer)}update(e){ey.exists(this);let{view:t,buffer:r,blockLen:i}=this;e=eE(e);let n=e.length;for(let a=0;a<n;){let s=Math.min(i-this.pos,n-a);if(s===i){let t=eb(e);for(;i<=n-a;a+=i)this.process(t,a);continue}r.set(e.subarray(a,a+s),this.pos),this.pos+=s,a+=s,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){ey.exists(this),ey.output(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:n}=this,{pos:a}=this;t[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>i-a&&(this.process(r,0),a=0);for(let e=a;e<i;e++)t[e]=0;!function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let n=BigInt(32),a=BigInt(4294967295),s=Number(r>>n&a),o=Number(r&a);e.setUint32(t+(i?4:0),s,i),e.setUint32(t+(i?0:4),o,i)}(r,i-8,BigInt(8*this.length),n),this.process(r,0);let s=eb(e),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=o/4,h=this.get();if(l>h.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<l;e++)s.setUint32(4*e,h[e],n)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:n,destroyed:a,pos:s}=this;return e.length=i,e.pos=s,e.finished=n,e.destroyed=a,i%t&&e.buffer.set(r),e}}let eH=(e,t,r)=>e&t^~e&r,eU=(e,t,r)=>e&t^e&r^t&r,eB=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),eI=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),eO=new Uint32Array(64);class eC extends eK{constructor(){super(64,32,8,!1),this.A=0|eI[0],this.B=0|eI[1],this.C=0|eI[2],this.D=0|eI[3],this.E=0|eI[4],this.F=0|eI[5],this.G=0|eI[6],this.H=0|eI[7]}get(){let{A:e,B:t,C:r,D:i,E:n,F:a,G:s,H:o}=this;return[e,t,r,i,n,a,s,o]}set(e,t,r,i,n,a,s,o){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|n,this.F=0|a,this.G=0|s,this.H=0|o}process(e,t){for(let r=0;r<16;r++,t+=4)eO[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=eO[e-15],r=eO[e-2],i=eg(t,7)^eg(t,18)^t>>>3,n=eg(r,17)^eg(r,19)^r>>>10;eO[e]=n+eO[e-7]+i+eO[e-16]|0}let{A:r,B:i,C:n,D:a,E:s,F:o,G:l,H:h}=this;for(let e=0;e<64;e++){let t=eg(s,6)^eg(s,11)^eg(s,25),u=h+t+eH(s,o,l)+eB[e]+eO[e]|0,c=eg(r,2)^eg(r,13)^eg(r,22),f=c+eU(r,i,n)|0;h=l,l=o,o=s,s=a+u|0,a=n,n=i,i=r,r=u+f|0}r=r+this.A|0,i=i+this.B|0,n=n+this.C|0,a=a+this.D|0,s=s+this.E|0,o=o+this.F|0,l=l+this.G|0,h=h+this.H|0,this.set(r,i,n,a,s,o,l,h)}roundClean(){eO.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class eL extends eC{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}let eR=eS(()=>new eC);eS(()=>new eL);let eD=BigInt(4294967296-1),ej=BigInt(32);function ez(e,t=!1){return t?{h:Number(e&eD),l:Number(e>>ej&eD)}:{h:0|Number(e>>ej&eD),l:0|Number(e&eD)}}let eT=(e,t)=>BigInt(e>>>0)<<ej|BigInt(t>>>0);var eW={fromBig:ez,split:function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let n=0;n<e.length;n++){let{h:a,l:s}=ez(e[n],t);[r[n],i[n]]=[a,s]}return[r,i]},toBig:eT,shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:(e,t,r)=>e<<r|t>>>32-r,rotlSL:(e,t,r)=>t<<r|e>>>32-r,rotlBH:(e,t,r)=>t<<r-32|e>>>64-r,rotlBL:(e,t,r)=>e<<r-32|t>>>64-r,add:function(e,t,r,i){let n=(t>>>0)+(i>>>0);return{h:e+r+(n/4294967296|0)|0,l:0|n}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,i)=>t+r+i+(e/4294967296|0)|0,add4L:(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),add4H:(e,t,r,i,n)=>t+r+i+n+(e/4294967296|0)|0,add5H:(e,t,r,i,n,a)=>t+r+i+n+a+(e/4294967296|0)|0,add5L:(e,t,r,i,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(n>>>0)};let[eN,e$]=eW.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),eM=new Uint32Array(80),eG=new Uint32Array(80);class eF extends eK{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:n,Cl:a,Dh:s,Dl:o,Eh:l,El:h,Fh:u,Fl:c,Gh:f,Gl:d,Hh:y,Hl:p}=this;return[e,t,r,i,n,a,s,o,l,h,u,c,f,d,y,p]}set(e,t,r,i,n,a,s,o,l,h,u,c,f,d,y,p){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|n,this.Cl=0|a,this.Dh=0|s,this.Dl=0|o,this.Eh=0|l,this.El=0|h,this.Fh=0|u,this.Fl=0|c,this.Gh=0|f,this.Gl=0|d,this.Hh=0|y,this.Hl=0|p}process(e,t){for(let r=0;r<16;r++,t+=4)eM[r]=e.getUint32(t),eG[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|eM[e-15],r=0|eG[e-15],i=eW.rotrSH(t,r,1)^eW.rotrSH(t,r,8)^eW.shrSH(t,r,7),n=eW.rotrSL(t,r,1)^eW.rotrSL(t,r,8)^eW.shrSL(t,r,7),a=0|eM[e-2],s=0|eG[e-2],o=eW.rotrSH(a,s,19)^eW.rotrBH(a,s,61)^eW.shrSH(a,s,6),l=eW.rotrSL(a,s,19)^eW.rotrBL(a,s,61)^eW.shrSL(a,s,6),h=eW.add4L(n,l,eG[e-7],eG[e-16]),u=eW.add4H(h,i,o,eM[e-7],eM[e-16]);eM[e]=0|u,eG[e]=0|h}let{Ah:r,Al:i,Bh:n,Bl:a,Ch:s,Cl:o,Dh:l,Dl:h,Eh:u,El:c,Fh:f,Fl:d,Gh:y,Gl:p,Hh:w,Hl:b}=this;for(let e=0;e<80;e++){let t=eW.rotrSH(u,c,14)^eW.rotrSH(u,c,18)^eW.rotrBH(u,c,41),g=eW.rotrSL(u,c,14)^eW.rotrSL(u,c,18)^eW.rotrBL(u,c,41),m=u&f^~u&y,v=c&d^~c&p,E=eW.add5L(b,g,v,e$[e],eG[e]),A=eW.add5H(E,w,t,m,eN[e],eM[e]),_=0|E,S=eW.rotrSH(r,i,28)^eW.rotrBH(r,i,34)^eW.rotrBH(r,i,39),P=eW.rotrSL(r,i,28)^eW.rotrBL(r,i,34)^eW.rotrBL(r,i,39),k=r&n^r&s^n&s,x=i&a^i&o^a&o;w=0|y,b=0|p,y=0|f,p=0|d,f=0|u,d=0|c,({h:u,l:c}=eW.add(0|l,0|h,0|A,0|_)),l=0|s,h=0|o,s=0|n,o=0|a,n=0|r,a=0|i;let K=eW.add3L(_,P,x);r=eW.add3H(K,A,S,k),i=0|K}({h:r,l:i}=eW.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:n,l:a}=eW.add(0|this.Bh,0|this.Bl,0|n,0|a)),({h:s,l:o}=eW.add(0|this.Ch,0|this.Cl,0|s,0|o)),({h:l,l:h}=eW.add(0|this.Dh,0|this.Dl,0|l,0|h)),({h:u,l:c}=eW.add(0|this.Eh,0|this.El,0|u,0|c)),({h:f,l:d}=eW.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:y,l:p}=eW.add(0|this.Gh,0|this.Gl,0|y,0|p)),({h:w,l:b}=eW.add(0|this.Hh,0|this.Hl,0|w,0|b)),this.set(r,i,n,a,s,o,l,h,u,c,f,d,y,p,w,b)}roundClean(){eM.fill(0),eG.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class eq extends eF{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}}class eJ extends eF{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}}class eZ extends eF{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}}let eV=eS(()=>new eF);eS(()=>new eq),eS(()=>new eJ);let eX=eS(()=>new eZ);class eY extends _{constructor(e,t){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:es.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}}),this.suiteId=t}buildLabeledIkm(e,t){let r=new Uint8Array(7+this.suiteId.byteLength+e.byteLength+t.byteLength);return r.set(K,0),r.set(this.suiteId,7),r.set(e,7+this.suiteId.byteLength),r.set(t,7+this.suiteId.byteLength+e.byteLength),r}buildLabeledInfo(e,t,r){let i=new Uint8Array(9+this.suiteId.byteLength+e.byteLength+t.byteLength);return i.set(new Uint8Array([0,r]),0),i.set(K,2),i.set(this.suiteId,9),i.set(e,9+this.suiteId.byteLength),i.set(t,9+this.suiteId.byteLength+e.byteLength),i}async extract(e,t){if(0===e.byteLength&&(e=new ArrayBuffer(this.hashSize)),e.byteLength!==this.hashSize)switch(this.algHash.hash){case"SHA-256":return ex(eR,new Uint8Array(e),new Uint8Array(t));case"SHA-384":return ex(eX,new Uint8Array(e),new Uint8Array(t));default:return ex(eV,new Uint8Array(e),new Uint8Array(t))}let r=await this._api.importKey("raw",e,this.algHash,!1,["sign"]);return await this._api.sign("HMAC",r,t)}async expand(e,t,r){let i=await this._api.importKey("raw",e,this.algHash,!1,["sign"]),n=new ArrayBuffer(r),a=new Uint8Array(n),s=x,o=new Uint8Array(t),l=new Uint8Array(1);if(r>255*this.hashSize)throw Error("Entropy limit reached");let h=new Uint8Array(this.hashSize+o.length+1);for(let e=1,t=0;t<a.length;e++)l[0]=e,h.set(s,0),h.set(o,s.length),h.set(l,s.length+o.length),s=new Uint8Array(await this._api.sign("HMAC",i,h.slice(0,s.length+o.length+1))),a.length-t>=s.length?(a.set(s,t),t+=s.length):(a.set(s.slice(0,a.length-t),t),t+=a.length-t);return n}async extractAndExpand(e,t,r,i){let n=await this._api.importKey("raw",t,"HKDF",!1,P);return await this._api.deriveBits({name:"HKDF",hash:this.algHash.hash,salt:e,info:r},n,8*i)}async labeledExtract(e,t,r){return await this.extract(e,this.buildLabeledIkm(t,r))}async labeledExpand(e,t,r,i){return await this.expand(e,this.buildLabeledInfo(t,r,i),i)}}class eQ extends eY{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:es.HkdfSha256}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-256",length:256}})}}class e0 extends eY{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:es.HkdfSha384}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-384",length:384}})}}class e1 extends eY{constructor(){super(...arguments),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:es.HkdfSha512}),Object.defineProperty(this,"hashSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"algHash",{enumerable:!0,configurable:!0,writable:!0,value:{name:"HMAC",hash:"SHA-512",length:512}})}}class e2 extends eu{async seal(e,t=x){let r;if(0===this._r.baseNonce.length)throw new f("Bidirectional encryption is not setup");try{r=await this._r.key.seal(this.computeNonce(this._r),e,t)}catch(e){throw new f(e)}return this.incrementSeq(this._r),r}async open(e,t=x){let r;try{r=await this._f.key.open(this.computeNonce(this._f),e,t)}catch(e){throw new d(e)}return this.incrementSeq(this._f),r}}class e5 extends eu{constructor(e,t,r,i){super(e,t,r),Object.defineProperty(this,"enc",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.enc=i}async seal(e,t=x){let r;try{r=await this._f.key.seal(this.computeNonce(this._f),e,t)}catch(e){throw new f(e)}return this.incrementSeq(this._f),r}async open(e,t=x){let r;if(0===this._r.baseNonce.length)throw new d("Bidirectional encryption is not setup");try{r=await this._r.key.open(this.computeNonce(this._r),e,t)}catch(e){throw new d(e)}return this.incrementSeq(this._r),r}}class e8{constructor(e){Object.defineProperty(this,"_num",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._num=new Uint8Array(e)}val(){return this._num}reset(){this._num.fill(0)}set(e){if(e.length!==this._num.length)throw Error("Bignum.set: invalid argument");this._num.set(e)}isZero(){for(let e=0;e<this._num.length;e++)if(0!==this._num[e])return!1;return!0}lessThan(e){if(e.length!==this._num.length)throw Error("Bignum.lessThan: invalid argument");for(let t=0;t<this._num.length;t++){if(this._num[t]<e[t])return!0;if(this._num[t]>e[t])break}return!1}}let e6=new Uint8Array([48,65,2,1,0,48,19,6,7,42,134,72,206,61,2,1,6,8,42,134,72,206,61,3,1,7,4,39,48,37,2,1,1,4,32]),e3=new Uint8Array([48,78,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,34,4,55,48,53,2,1,1,4,48]),e4=new Uint8Array([48,96,2,1,0,48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,35,4,73,48,71,2,1,1,4,66]);class e9{constructor(e,t,r){switch(Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_alg",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nDh",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_bitmask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pkcs8AlgId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=t,this._api=r,e){case ea.DhkemP256HkdfSha256:this._alg={name:"ECDH",namedCurve:"P-256"},this._nPk=65,this._nSk=32,this._nDh=32,this._order=$,this._bitmask=255,this._pkcs8AlgId=e6;break;case ea.DhkemP384HkdfSha384:this._alg={name:"ECDH",namedCurve:"P-384"},this._nPk=97,this._nSk=48,this._nDh=48,this._order=M,this._bitmask=255,this._pkcs8AlgId=e3;break;default:this._alg={name:"ECDH",namedCurve:"P-521"},this._nPk=133,this._nSk=66,this._nDh=66,this._order=G,this._bitmask=1,this._pkcs8AlgId=e4}}async serializePublicKey(e){let t=await this._api.exportKey("raw",e);if(t.byteLength!==this._nPk)throw Error("Invalid public key for the ciphersuite");return t}async deserializePublicKey(e){if(e.byteLength!==this._nPk)throw Error("Invalid public key for the ciphersuite");try{return await this._api.importKey("raw",e,this._alg,!0,[])}catch(e){throw Error("Invalid public key for the ciphersuite")}}async importKey(e,t,r){if("raw"!==e)throw Error("Unsupported format");if(r&&t.byteLength!==this._nPk)throw Error("Invalid public key for the ciphersuite");if(!r&&t.byteLength!==this._nSk)throw Error("Invalid private key for the ciphersuite");try{if(r)return await this._api.importKey(e,t,this._alg,!0,[]);let i=new Uint8Array(t),n=new Uint8Array(this._pkcs8AlgId.length+i.length);return n.set(this._pkcs8AlgId,0),n.set(i,this._pkcs8AlgId.length),await this._api.importKey("pkcs8",n,this._alg,!0,P)}catch(e){throw Error("Invalid key for the ciphersuite")}}async derivePublicKey(e){let t=await this._api.exportKey("jwk",e);return delete t.d,delete t.key_ops,await this._api.importKey("jwk",t,this._alg,!0,[])}async generateKeyPair(){return await this._api.generateKey(this._alg,!0,P)}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(x,B,new Uint8Array(e)),r=new e8(this._nSk);for(let e=0;r.isZero()||!r.lessThan(this._order);e++){if(e>255)throw Error("Faild to derive a key pair");let i=new Uint8Array(await this._hkdf.labeledExpand(t,W,E(e,1),this._nSk));i[0]=i[0]&this._bitmask,r.set(i)}let i=new Uint8Array(this._pkcs8AlgId.length+r.val().length);i.set(this._pkcs8AlgId,0),i.set(r.val(),this._pkcs8AlgId.length);let n=await this._api.importKey("pkcs8",i,this._alg,!0,P);return r.reset(),{privateKey:n,publicKey:await this.derivePublicKey(n)}}async dh(e,t){let r=await this._api.deriveBits({name:"ECDH",public:t},e,8*this._nDh);return r}}var e7=r(5856),te=r.t(e7,2);/*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) */let tt=BigInt(0),tr=BigInt(1),ti=BigInt(2),tn=BigInt(3),ta=BigInt(8),ts=Object.freeze({a:tt,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:tr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),to=(e,t)=>(e+t/ti)/t,tl={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=ts,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),i=-tr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=BigInt("0x100000000000000000000000000000000"),s=to(r*e,t),o=to(-i*e,t),l=tI(e-s*r-o*n,t),h=tI(-s*i-o*r,t),u=l>a,c=h>a;if(u&&(l=t-l),c&&(h=t-h),l>a||h>a)throw Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:u,k1:l,k2neg:c,k2:h}}};function th(e){let{a:t,b:r}=ts,i=tI(e*e),n=tI(i*e);return tI(n+t*e+r)}let tu=ts.a===tt;class tc extends Error{constructor(e){super(e)}}function tf(e){if(!(e instanceof td))throw TypeError("JacobianPoint expected")}class td{constructor(e,t,r){this.x=e,this.y=t,this.z=r}static fromAffine(e){if(!(e instanceof tw))throw TypeError("JacobianPoint#fromAffine: expected Point");return e.equals(tw.ZERO)?td.ZERO:new td(e.x,e.y,tr)}static toAffineBatch(e){let t=function(e,t=ts.P){let r=Array(e.length),i=e.reduce((e,i,n)=>i===tt?e:(r[n]=e,tI(e*i,t)),tr),n=tC(i,t);return e.reduceRight((e,i,n)=>i===tt?e:(r[n]=tI(e*r[n],t),tI(e*i,t)),n),r}(e.map(e=>e.z));return e.map((e,r)=>e.toAffine(t[r]))}static normalizeZ(e){return td.toAffineBatch(e).map(td.fromAffine)}equals(e){tf(e);let{x:t,y:r,z:i}=this,{x:n,y:a,z:s}=e,o=tI(i*i),l=tI(s*s),h=tI(t*l),u=tI(n*o),c=tI(tI(r*s)*l),f=tI(tI(a*i)*o);return h===u&&c===f}negate(){return new td(this.x,tI(-this.y),this.z)}double(){let{x:e,y:t,z:r}=this,i=tI(e*e),n=tI(t*t),a=tI(n*n),s=e+n,o=tI(ti*(tI(s*s)-i-a)),l=tI(tn*i),h=tI(l*l),u=tI(h-ti*o),c=tI(l*(o-u)-ta*a),f=tI(ti*t*r);return new td(u,c,f)}add(e){tf(e);let{x:t,y:r,z:i}=this,{x:n,y:a,z:s}=e;if(n===tt||a===tt)return this;if(t===tt||r===tt)return e;let o=tI(i*i),l=tI(s*s),h=tI(t*l),u=tI(n*o),c=tI(tI(r*s)*l),f=tI(tI(a*i)*o),d=tI(u-h),y=tI(f-c);if(d===tt)return y===tt?this.double():td.ZERO;let p=tI(d*d),w=tI(d*p),b=tI(h*p),g=tI(y*y-w-ti*b),m=tI(y*(b-g)-c*w),v=tI(i*s*d);return new td(g,m,v)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let t=td.ZERO;if("bigint"==typeof e&&e===tt)return t;let r=tB(e);if(r===tr)return this;if(!tu){let e=t,i=this;for(;r>tt;)r&tr&&(e=e.add(i)),i=i.double(),r>>=tr;return e}let{k1neg:i,k1:n,k2neg:a,k2:s}=tl.splitScalar(r),o=t,l=t,h=this;for(;n>tt||s>tt;)n&tr&&(o=o.add(h)),s&tr&&(l=l.add(h)),h=h.double(),n>>=tr,s>>=tr;return i&&(o=o.negate()),a&&(l=l.negate()),l=new td(tI(l.x*tl.beta),l.y,l.z),o.add(l)}precomputeWindow(e){let t=tu?128/e+1:256/e+1,r=[],i=this,n=i;for(let a=0;a<t;a++){n=i,r.push(n);for(let t=1;t<2**(e-1);t++)n=n.add(i),r.push(n);i=n.double()}return r}wNAF(e,t){!t&&this.equals(td.BASE)&&(t=tw.BASE);let r=t&&t._WINDOW_SIZE||1;if(256%r)throw Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=t&&tp.get(t);!i&&(i=this.precomputeWindow(r),t&&1!==r&&(i=td.normalizeZ(i),tp.set(t,i)));let n=td.ZERO,a=td.BASE,s=1+(tu?128/r:256/r),o=2**(r-1),l=BigInt(2**r-1),h=2**r,u=BigInt(r);for(let t=0;t<s;t++){let r=t*o,s=Number(e&l);e>>=u,s>o&&(s-=h,e+=tr);let c=r+Math.abs(s)-1,f=t%2!=0,d=s<0;0===s?a=a.add(ty(f,i[r])):n=n.add(ty(d,i[c]))}return{p:n,f:a}}multiply(e,t){let r,i,n=tB(e);if(tu){let{k1neg:e,k1:a,k2neg:s,k2:o}=tl.splitScalar(n),{p:l,f:h}=this.wNAF(a,t),{p:u,f:c}=this.wNAF(o,t);l=ty(e,l),u=ty(s,u),u=new td(tI(u.x*tl.beta),u.y,u.z),r=l.add(u),i=h.add(c)}else{let{p:e,f:a}=this.wNAF(n,t);r=e,i=a}return td.normalizeZ([r,i])[0]}toAffine(e){let{x:t,y:r,z:i}=this,n=this.equals(td.ZERO);null==e&&(e=n?ta:tC(i));let a=e,s=tI(a*a),o=tI(s*a),l=tI(t*s),h=tI(r*o),u=tI(i*a);if(n)return tw.ZERO;if(u!==tr)throw Error("invZ was invalid");return new tw(l,h)}}function ty(e,t){let r=t.negate();return e?r:t}td.BASE=new td(ts.Gx,ts.Gy,tr),td.ZERO=new td(tt,tr,tt);let tp=new WeakMap;class tw{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,tp.delete(this)}hasEvenY(){return this.y%ti===tt}static fromCompressedHex(e){let t=32===e.length,r=tH(t?e:e.subarray(1));if(!tR(r))throw Error("Point is not on curve");let i=th(r),n=function(e){let{P:t}=ts,r=BigInt(6),i=BigInt(11),n=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),l=e*e*e%t,h=l*l*e%t,u=tO(h,tn)*h%t,c=tO(u,tn)*h%t,f=tO(c,ti)*l%t,d=tO(f,i)*f%t,y=tO(d,n)*d%t,p=tO(y,s)*y%t,w=tO(p,o)*p%t,b=tO(w,s)*y%t,g=tO(b,tn)*h%t,m=tO(g,a)*d%t,v=tO(m,r)*l%t,E=tO(v,ti);if(E*E%t!==e)throw Error("Cannot find square root");return E}(i),a=(n&tr)===tr;if(t)a&&(n=tI(-n));else{let t=(1&e[0])==1;t!==a&&(n=tI(-n))}let s=new tw(r,n);return s.assertValidity(),s}static fromUncompressedHex(e){let t=tH(e.subarray(1,33)),r=tH(e.subarray(33,65)),i=new tw(t,r);return i.assertValidity(),i}static fromHex(e){let t=tU(e),r=t.length,i=t[0];if(32===r||33===r&&(2===i||3===i))return this.fromCompressedHex(t);if(65===r&&4===i)return this.fromUncompressedHex(t);throw Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${r}`)}static fromPrivateKey(e){return tw.BASE.multiply(tD(e))}static fromSignature(e,t,r){let{r:i,s:n}=function(e){if(e instanceof tm)return e.assertValidity(),e;try{return tm.fromDER(e)}catch(t){return tm.fromCompact(e)}}(t);if(![0,1,2,3].includes(r))throw Error("Cannot recover: invalid recovery bit");let a=function(e,t=!1){let r=function(e){let t=8*e.length-256,r=tH(e);return t>0?r>>BigInt(t):r}(e);if(t)return r;let{n:i}=ts;return r>=i?r-i:r}(tU(e)),{n:s}=ts,o=2===r||3===r?i+s:i,l=tC(o,s),h=tI(-a*l,s),u=tI(n*l,s),c=tw.fromHex((1&r?"03":"02")+tS(o)),f=tw.BASE.multiplyAndAddUnsafe(c,h,u);if(!f)throw Error("Cannot recover signature: point at infinify");return f.assertValidity(),f}toRawBytes(e=!1){return tK(this.toHex(e))}toHex(e=!1){let t=tS(this.x);if(!e)return`04${t}${tS(this.y)}`;{let e=this.hasEvenY()?"02":"03";return`${e}${t}`}}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:t,y:r}=this;if(!tR(t)||!tR(r))throw Error(e);let i=tI(r*r),n=th(t);if(tI(i-n)!==tt)throw Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new tw(this.x,tI(-this.y))}double(){return td.fromAffine(this).double().toAffine()}add(e){return td.fromAffine(this).add(td.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return td.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,t,r){let i=td.fromAffine(this),n=t===tt||t===tr||this!==tw.BASE?i.multiplyUnsafe(t):i.multiply(t),a=td.fromAffine(e).multiplyUnsafe(r),s=n.add(a);return s.equals(td.ZERO)?void 0:s.toAffine()}}function tb(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function tg(e){if(e.length<2||2!==e[0])throw Error(`Invalid signature integer tag: ${tA(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw Error("Invalid signature integer: trailing length");return{data:tH(r),left:e.subarray(t+2)}}tw.BASE=new tw(ts.Gx,ts.Gy),tw.ZERO=new tw(tt,tt);class tm{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromCompact(e){let t=e instanceof Uint8Array,r="Signature.fromCompact";if("string"!=typeof e&&!t)throw TypeError(`${r}: Expected string or Uint8Array`);let i=t?tA(e):e;if(128!==i.length)throw Error(`${r}: Expected 64-byte hex`);return new tm(tx(i.slice(0,64)),tx(i.slice(64,128)))}static fromDER(e){let t=e instanceof Uint8Array;if("string"!=typeof e&&!t)throw TypeError("Signature.fromDER: Expected string or Uint8Array");let{r,s:i}=function(e){if(e.length<2||48!=e[0])throw Error(`Invalid signature tag: ${tA(e)}`);if(e[1]!==e.length-2)throw Error("Invalid signature: incorrect length");let{data:t,left:r}=tg(e.subarray(2)),{data:i,left:n}=tg(r);if(n.length)throw Error(`Invalid signature: left bytes after parsing: ${tA(n)}`);return{r:t,s:i}}(t?e:tK(e));return new tm(r,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:t}=this;if(!tL(e))throw Error("Invalid Signature: r must be 0 < r < n");if(!tL(t))throw Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ts.n>>tr;return this.s>e}normalizeS(){return this.hasHighS()?new tm(this.r,tI(-this.s,ts.n)):this}toDERRawBytes(){return tK(this.toDERHex())}toDERHex(){let e=tb(tk(this.s)),t=tb(tk(this.r)),r=e.length/2,i=t.length/2,n=tk(r),a=tk(i),s=tk(i+r+4);return`30${s}02${a}${t}02${n}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return tK(this.toCompactHex())}toCompactHex(){return tS(this.r)+tS(this.s)}}function tv(...e){if(!e.every(e=>e instanceof Uint8Array))throw Error("Uint8Array list expected");if(1===e.length)return e[0];let t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}let tE=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tA(e){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=tE[e[r]];return t}let t_=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function tS(e){if("bigint"!=typeof e)throw Error("Expected bigint");if(!(tt<=e&&e<t_))throw Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function tP(e){let t=tK(tS(e));if(32!==t.length)throw Error("Error: expected 32 bytes");return t}function tk(e){let t=e.toString(16);return 1&t.length?`0${t}`:t}function tx(e){if("string"!=typeof e)throw TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function tK(e){if("string"!=typeof e)throw TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let i=2*r,n=e.slice(i,i+2),a=Number.parseInt(n,16);if(Number.isNaN(a)||a<0)throw Error("Invalid byte sequence");t[r]=a}return t}function tH(e){return tx(tA(e))}function tU(e){return e instanceof Uint8Array?Uint8Array.from(e):tK(e)}function tB(e){if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"==typeof e&&tL(e))return e;throw TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function tI(e,t=ts.P){let r=e%t;return r>=tt?r:t+r}function tO(e,t){let{P:r}=ts,i=e;for(;t-- >tt;)i*=i,i%=r;return i}function tC(e,t=ts.P){if(e===tt||t<=tt)throw Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=tI(e,t),i=t,n=tt,a=tr,s=tr,o=tt;for(;r!==tt;){let e=i/r,t=i%r,l=n-s*e,h=a-o*e;i=r,r=t,n=s,a=o,s=l,o=h}let l=i;if(l!==tr)throw Error("invert: does not exist");return tI(n,t)}function tL(e){return tt<e&&e<ts.n}function tR(e){return tt<e&&e<ts.P}function tD(e){let t;if("bigint"==typeof e)t=e;else if("number"==typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"==typeof e){if(64!==e.length)throw Error("Expected 32 bytes of private key");t=tx(e)}else if(e instanceof Uint8Array){if(32!==e.length)throw Error("Expected 32 bytes of private key");t=tH(e)}else throw TypeError("Expected valid private key");if(!tL(t))throw Error("Expected private key: 0 < key < n");return t}function tj(e){let t=e instanceof Uint8Array,r="string"==typeof e,i=(t||r)&&e.length;return t?33===i||65===i:r?66===i||130===i:e instanceof tw}tw.BASE._setWindowSize(8);let tz={node:te,web:"object"==typeof self&&"crypto"in self?self.crypto:void 0},tT={},tW={bytesToHex:tA,hexToBytes:tK,concatBytes:tv,mod:tI,invert:tC,isValidPrivateKey(e){try{return tD(e),!0}catch(e){return!1}},_bigintTo32Bytes:tP,_normalizePrivateKey:tD,hashToPrivateKey:e=>{if((e=tU(e)).length<40||e.length>1024)throw Error("Expected valid bytes of private key as per FIPS 186");let t=tI(tH(e),ts.n-tr)+tr;return tP(t)},randomBytes:(e=32)=>{if(tz.web)return tz.web.getRandomValues(new Uint8Array(e));if(tz.node){let{randomBytes:t}=tz.node;return Uint8Array.from(t(e))}throw Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>tW.hashToPrivateKey(tW.randomBytes(40)),precompute(e=8,t=tw.BASE){let r=t===tw.BASE?t:new tw(t.x,t.y);return r._setWindowSize(e),r.multiply(tn),r},sha256:async(...e)=>{if(tz.web){let t=await tz.web.subtle.digest("SHA-256",tv(...e));return new Uint8Array(t)}if(tz.node){let{createHash:t}=tz.node,r=t("sha256");return e.forEach(e=>r.update(e)),Uint8Array.from(r.digest())}throw Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(tz.web){let r=await tz.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),i=tv(...t),n=await tz.web.subtle.sign("HMAC",r,i);return new Uint8Array(n)}if(tz.node){let{createHmac:r}=tz.node,i=r("sha256",e);return t.forEach(e=>i.update(e)),Uint8Array.from(i.digest())}throw Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=tT[e];if(void 0===r){let t=await tW.sha256(Uint8Array.from(e,e=>e.charCodeAt(0)));r=tv(t,t),tT[e]=r}return tW.sha256(r,...t)},taggedHashSync:(e,...t)=>{if("function"!=typeof i)throw new tc("sha256Sync is undefined, you need to set it");let r=tT[e];if(void 0===r){let t=i(Uint8Array.from(e,e=>e.charCodeAt(0)));r=tv(t,t),tT[e]=r}return i(r,...t)},_JacobianPoint:td};Object.defineProperties(tW,{sha256Sync:{configurable:!1,get:()=>i,set(e){i||(i=e)}},hmacSha256Sync:{configurable:!1,get:()=>n,set(e){n||(n=e)}}});class tN{constructor(e,t,r){Object.defineProperty(this,"key",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extractable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"algorithm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"usages",{enumerable:!0,configurable:!0,writable:!0,value:P}),this.key=t,this.type=r,this.algorithm={name:e}}}let t$="ECDH";class tM{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=65,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,r){if("raw"!==e)throw Error("Unsupported format");return await this._importKey(t,r)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=tW.randomPrivateKey(),t=new tN(t$,e,"private"),r=await this.derivePublicKey(t);return{publicKey:r,privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(x,B,new Uint8Array(e)),r=await this._hkdf.labeledExpand(t,N,x,this._nSk),i=new tN(t$,new Uint8Array(r),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,r)=>{e.byteLength!==this._nPk?r(Error("Invalid public key for the ciphersuite")):t(new tN(t$,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((r,i)=>{t&&e.byteLength!==this._nPk&&i(Error("Invalid public key for the ciphersuite")),t||e.byteLength===this._nSk||i(Error("Invalid private key for the ciphersuite")),r(new tN(t$,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let r=function(e,t=!1){return tw.fromPrivateKey(e).toRawBytes(t)}(e.key);t(new tN(t$,r,"public"))})}_dh(e,t){return new Promise((r,i)=>{try{r(function(e,t,r=!1){if(tj(e))throw TypeError("getSharedSecret: first arg must be private key");if(!tj(t))throw TypeError("getSharedSecret: second arg must be public key");let i=t instanceof tw?(t.assertValidity(),t):tw.fromHex(t);return i.assertValidity(),i.multiply(tD(e)).toRawBytes(r)}(e.key,t.key).buffer)}catch(e){i(e)}})}}BigInt(0);let tG=BigInt(1),tF=BigInt(2),tq=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tJ(e){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=tq[e[r]];return t}function tZ(e){if("string"!=typeof e)throw TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw Error("hexToBytes: received invalid unpadded hex "+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let i=2*r,n=e.slice(i,i+2),a=Number.parseInt(n,16);if(Number.isNaN(a)||a<0)throw Error("Invalid byte sequence");t[r]=a}return t}function tV(e){return function(e){if("string"!=typeof e)throw TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}(tJ(e))}function tX(e){if(!(e instanceof Uint8Array))throw Error("Expected Uint8Array");return BigInt("0x"+tJ(Uint8Array.from(e).reverse()))}let tY=(e,t)=>tZ(e.toString(16).padStart(2*t,"0")),tQ=(e,t)=>tY(e,t).reverse();function t0(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):tZ(e);if("number"==typeof t&&r.length!==t)throw Error(`Expected ${t} bytes`);return r}function t1(...e){if(!e.every(e=>e instanceof Uint8Array))throw Error("Uint8Array list expected");if(1===e.length)return e[0];let t=e.reduce((e,t)=>e+t.length,0),r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let n=e[t];r.set(n,i),i+=n.length}return r}function t2(e,t){let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}let t5=e=>(tF<<BigInt(e-1))-tG,t8=BigInt(0),t6=BigInt(1),t3=BigInt(2),t4=BigInt(3),t9=BigInt(4),t7=BigInt(5),re=BigInt(8);function rt(e,t){let r=e%t;return r>=t8?r:t+r}function rr(e,t,r){if(r<=t8||t<t8)throw Error("Expected power/modulo > 0");if(r===t6)return t8;let i=t6;for(;t>t8;)t&t6&&(i=i*e%r),e=e*e%r,t>>=t6;return i}function ri(e,t,r){let i=e;for(;t-- >t8;)i*=i,i%=r;return i}function rn(e,t){if(e===t8||t<=t8)throw Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=rt(e,t),i=t,n=t8,a=t6,s=t6,o=t8;for(;r!==t8;){let e=i/r,t=i%r,l=n-s*e,h=a-o*e;i=r,r=t,n=s,a=o,s=l,o=h}let l=i;if(l!==t6)throw Error("invert: does not exist");return rt(n,t)}BigInt(9),BigInt(16);let ra=(e,t)=>(rt(e,t)&t6)===t6,rs=["create","isValid","isZero","negate","invert","sqrt","square","equals","add","sub","mul","pow","div","addN","subN","mulN","squareN"];function ro(e,t,r=!1,i={}){if(e<=t8)throw Error(`Expected Fp ORDER > 0, got ${e}`);let{nBitLength:n,nByteLength:a}=t2(e,t);if(a>2048)throw Error("Field lengths over 2048 bytes are not supported");let s=function(e){if(e%t9===t4){let t=(e+t6)/t9;return function(e,r){let i=e.pow(r,t);if(!e.equals(e.square(i),r))throw Error("Cannot find square root");return i}}if(e%re===t7){let t=(e-t7)/re;return function(e,r){let i=e.mul(r,t3),n=e.pow(i,t),a=e.mul(r,n),s=e.mul(e.mul(a,t3),n),o=e.mul(a,e.sub(s,e.ONE));if(!e.equals(e.square(o),r))throw Error("Cannot find square root");return o}}return function(e){let t,r,i;let n=(e-t6)/t3;for(t=e-t6,r=0;t%t3===t8;t/=t3,r++);for(i=t3;i<e&&rr(i,n,e)!==e-t6;i++);if(1===r){let t=(e+t6)/t9;return function(e,r){let i=e.pow(r,t);if(!e.equals(e.square(i),r))throw Error("Cannot find square root");return i}}let a=(t+t6)/t3;return function(s,o){if(s.pow(o,n)!==s.ONE)throw Error("Cannot find square root");let l=r,h=rr(i,t,e),u=s.pow(o,a),c=s.pow(o,t),f=s.ZERO;for(;!s.equals(s.sub(c,s.ONE),s.ZERO);){let t;for(t=1,f=s.square(c);t<l&&!s.equals(s.sub(f,s.ONE),s.ZERO);t++)f=s.square(f);let r=rr(h,BigInt(1<<l-t-1),e);u=s.mul(u,r),h=rt(r*r,e),c=s.mul(c,h),l=t}return u}}(e)}(e),o=Object.freeze({ORDER:e,BITS:n,BYTES:a,MASK:t5(n),ZERO:t8,ONE:t6,create:t=>rt(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error(`Invalid field element: expected bigint, got ${typeof t}`);return t8<=t&&t<e},isZero:e=>e===t8,isOdd:e=>(e&t6)===t6,negate:t=>rt(-t,e),equals:(e,t)=>e===t,square:t=>rt(t*t,e),add:(t,r)=>rt(t+r,e),sub:(t,r)=>rt(t-r,e),mul:(t,r)=>rt(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<t8)throw Error("Expected power > 0");if(r===t8)return e.ONE;if(r===t6)return t;let i=e.ONE,n=t;for(;r>t8;)r&t6&&(i=e.mul(i,n)),n=e.square(n),r>>=1n;return i})(o,e,t),div:(t,r)=>rt(t*rn(r,e),e),squareN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,invert:t=>rn(t,e),sqrt:i.sqrt||(e=>s(o,e)),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,n)=>e.isZero(i)?t:(r[n]=t,e.mul(t,i)),e.ONE),n=e.invert(i);return t.reduceRight((t,i,n)=>e.isZero(i)?t:(r[n]=e.mul(t,r[n]),e.mul(t,i)),n),r})(o,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?tQ(e,a):tY(e,a),fromBytes:e=>{if(e.length!==a)throw Error(`Fp.fromBytes: expected ${a}, got ${e.length}`);return r?tX(e):tV(e)}});return Object.freeze(o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let rl=BigInt(0),rh=BigInt(1);function ru(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}function rc(e,t){if(e<0||e>=1<<8*t)throw Error(`bad I2OSP call: value=${e} length=${t}`);let r=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)r[i]=255&e,e>>>=8;return new Uint8Array(r)}function rf(e,t,r){let i=r.p.toString(2).length,n=Math.ceil((i+r.k)/8),a=t*r.m*n,s=ru(r.DST),o=e;"xmd"===r.expand?o=function(e,t,r,i){t.length>255&&(t=i(t1(ru("H2C-OVERSIZE-DST-"),t)));let n=i.outputLen,a=i.blockLen,s=Math.ceil(r/n);if(s>255)throw Error("Invalid xmd length");let o=t1(t,rc(t.length,1)),l=rc(0,a),h=rc(r,2),u=Array(s),c=i(t1(l,e,h,rc(0,1),o));u[0]=i(t1(c,rc(1,1),o));for(let e=1;e<=s;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r}(c,u[e-1]),rc(e+1,1),o];u[e]=i(t1(...t))}let f=t1(...u);return f.slice(0,r)}(e,s,a,r.hash):"xof"===r.expand&&(o=function(e,t,r,i,n){if(t.length>255&&(t=n.create({dkLen:Math.ceil(2*i/8)}).update(ru("H2C-OVERSIZE-DST-")).update(t).digest()),r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return n.create({dkLen:r}).update(e).update(rc(r,2)).update(t).update(rc(t.length,1)).digest()}(e,s,a,r.k,r.hash));let l=Array(t);for(let e=0;e<t;e++){let t=Array(r.m);for(let i=0;i<r.m;i++){let a=n*(i+e*r.m),s=o.subarray(a,a+n);t[i]=rt(function(e){let t=0n;for(let r=0;r<e.length;r++)t<<=8n,t+=BigInt(e[r]);return t}(s),r.p)}l[e]=t}return l}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let rd=BigInt(0),ry=BigInt(1),rp=BigInt(2),rw=BigInt(8);function rb(e){let t=function(e){let t=function(e){for(let t of(function(e){for(let t of["ORDER","MASK"])if("bigint"!=typeof e[t])throw Error(`Invalid field param ${t}=${e[t]} (${typeof e[t]})`);for(let t of["BYTES","BITS"])if("number"!=typeof e[t])throw Error(`Invalid field param ${t}=${e[t]} (${typeof e[t]})`);for(let t of rs)if("function"!=typeof e[t])throw Error(`Invalid field param ${t}=${e[t]} (${typeof e[t]})`)}(e.Fp),["n","h"]))if("bigint"!=typeof e[t])throw Error(`Invalid curve param ${t}=${e[t]} (${typeof e[t]})`);if(!e.Fp.isValid(e.Gx))throw Error("Invalid generator X coordinate Fp element");if(!e.Fp.isValid(e.Gy))throw Error("Invalid generator Y coordinate Fp element");for(let t of["nBitLength","nByteLength"])if(void 0!==e[t]&&!Number.isSafeInteger(e[t]))throw Error(`Invalid curve param ${t}=${e[t]} (${typeof e[t]})`);return Object.freeze({...t2(e.n,e.nBitLength),...e})}(e);if("function"!=typeof t.hash||!Number.isSafeInteger(t.hash.outputLen))throw Error("Invalid hash function");for(let e of["a","d"])if("bigint"!=typeof t[e])throw Error(`Invalid curve param ${e}=${t[e]} (${typeof t[e]})`);for(let e of["randomBytes"])if("function"!=typeof t[e])throw Error(`Invalid ${e} function`);for(let e of["adjustScalarBytes","domain","uvRatio","mapToCurve","clearCofactor"])if(void 0!==t[e]&&"function"!=typeof t[e])throw Error(`Invalid ${e} function`);return void 0!==t.htfDefaults&&/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function(e){if("string"!=typeof e.DST)throw Error("Invalid htf/DST");if("bigint"!=typeof e.p)throw Error("Invalid htf/p");if("number"!=typeof e.m)throw Error("Invalid htf/m");if("number"!=typeof e.k)throw Error("Invalid htf/k");if("xmd"!==e.expand&&"xof"!==e.expand&&void 0!==e.expand)throw Error("Invalid htf/expand");if("function"!=typeof e.hash||!Number.isSafeInteger(e.hash.outputLen))throw Error("Invalid htf/hash function")}(t.htfDefaults),Object.freeze({...t})}(e),r=t.Fp,i=t.n,n=r.BYTES;if(n>2048)throw Error("Field lengths over 2048 are not supported");let a=t.nByteLength,s=rp**BigInt(8*a),{randomBytes:o}=t,l=r.create,h=t.uvRatio||function(e,t){try{let i=r.sqrt(e*r.invert(t));return{isValid:!0,value:i}}catch(e){return{isValid:!1,value:rd}}},u=t.adjustScalarBytes||(e=>e),c=t.domain||function(e,t,r){if(t.length||r)throw Error("Contexts/pre-hash are not supported");return e};class f{constructor(e,t,r,i){this.x=e,this.y=t,this.z=r,this.t=i}static fromAffine(e){if(!(e instanceof w))throw TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(w.ZERO)?f.ZERO:new f(e.x,e.y,ry,l(e.x*e.y))}static toAffineBatch(e){let t=r.invertBatch(e.map(e=>e.z));return e.map((e,r)=>e.toAffine(t[r]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){y(e);let{x:t,y:r,z:i}=this,{x:n,y:a,z:s}=e,o=l(t*s),h=l(n*i),u=l(r*s),c=l(a*i);return o===h&&u===c}negate(){return new f(l(-this.x),this.y,this.z,l(-this.t))}double(){let{a:e}=t,{x:r,y:i,z:n}=this,a=l(r*r),s=l(i*i),o=l(rp*l(n*n)),h=l(e*a),u=r+i,c=l(l(u*u)-a-s),d=h+s,y=d-o,p=h-s,w=l(c*y),b=l(d*p),g=l(c*p),m=l(y*d);return new f(w,b,m,g)}add(e){y(e);let{a:r,d:i}=t,{x:n,y:a,z:s,t:o}=this,{x:h,y:u,z:c,t:d}=e;if(r===BigInt(-1)){let e=l((a-n)*(u+h)),t=l((a+n)*(u-h)),r=l(t-e);if(r===rd)return this.double();let i=l(s*rp*d),y=l(o*rp*c),p=y+i,w=t+e,b=y-i,g=l(p*r),m=l(w*b),v=l(p*b),E=l(r*w);return new f(g,m,E,v)}let p=l(n*h),w=l(a*u),b=l(o*i*d),g=l(s*c),m=l((n+a)*(h+u)-p-w),v=g-b,E=g+b,A=l(w-r*p),_=l(m*v),S=l(E*A),P=l(m*A),k=l(v*E);return new f(_,S,k,P)}subtract(e){return this.add(e.negate())}wNAF(e,t){!t&&this.equals(f.BASE)&&(t=w.BASE);let r=t&&t._WINDOW_SIZE||1,i=t&&p.get(t);!i&&(i=d.precomputeWindow(this,r),t&&1!==r&&(i=f.normalizeZ(i),p.set(t,i)));let{p:n,f:a}=d.wNAF(r,i,e);return f.normalizeZ([n,a])[0]}multiply(e,t){return this.wNAF(g(e,i),t)}multiplyUnsafe(e){let t=g(e,i,!1),r=f.BASE,n=f.ZERO;return t===rd?n:this.equals(n)||t===ry?this:this.equals(r)?this.wNAF(t):d.unsafeLadder(this,t)}isSmallOrder(){return this.multiplyUnsafe(t.h).equals(f.ZERO)}isTorsionFree(){return this.multiplyUnsafe(i).equals(f.ZERO)}toAffine(e){let{x:t,y:i,z:n}=this,a=this.equals(f.ZERO);null==e&&(e=a?rw:r.invert(n));let s=l(t*e),o=l(i*e),h=l(n*e);if(a)return w.ZERO;if(h!==ry)throw Error("invZ was invalid");return new w(s,o)}clearCofactor(){return t.h===ry?this:t.clearCofactor?t.clearCofactor(f,this):this.multiplyUnsafe(t.h)}}f.BASE=new f(t.Gx,t.Gy,ry,l(t.Gx*t.Gy)),f.ZERO=new f(rd,ry,ry,rd);let d=function(e,t){let r=(e,t)=>{let r=t.negate();return e?r:t},i=e=>({windows:Math.ceil(t/e)+1,windowSize:2**(e-1)});return{constTimeNegate:r,unsafeLadder(t,r){let i=e.ZERO,n=t;for(;r>rl;)r&rh&&(i=i.add(n)),n=n.double(),r>>=rh;return i},precomputeWindow(e,t){let{windows:r,windowSize:n}=i(t),a=[],s=e,o=s;for(let e=0;e<r;e++){o=s,a.push(o);for(let e=1;e<n;e++)o=o.add(s),a.push(o);s=o.double()}return a},wNAF(t,n,a){let{windows:s,windowSize:o}=i(t),l=e.ZERO,h=e.BASE,u=BigInt(2**t-1),c=2**t,f=BigInt(t);for(let e=0;e<s;e++){let t=e*o,i=Number(a&u);a>>=f,i>o&&(i-=c,a+=rh);let s=t+Math.abs(i)-1,d=e%2!=0,y=i<0;0===i?h=h.add(r(d,n[t])):l=l.add(r(y,n[s]))}return{p:l,f:h}}}}(f,8*a);function y(e){if(!(e instanceof f))throw TypeError("ExtendedPoint expected")}let p=new WeakMap;class w{constructor(e,t){this.x=e,this.y=t}_setWindowSize(e){this._WINDOW_SIZE=e,p.delete(this)}static fromHex(e,i=!0){let{d:a,a:o}=t;e=t0(e,n);let u=e.slice(),c=e[n-1];u[n-1]=-129&c;let f=tX(u);if(i&&f>=r.ORDER)throw Error("Expected 0 < hex < P");if(!i&&f>=s)throw Error("Expected 0 < hex < 2**256");let d=l(f*f),y=l(d-ry),p=l(a*d-o),{isValid:b,value:g}=h(y,p);if(!b)throw Error("Point.fromHex: invalid y coordinate");let m=(g&ry)===ry;return(128&c)!=0!==m&&(g=l(-g)),new w(g,f)}static fromPrivateKey(e){return m(e).point}toRawBytes(){let e=tQ(this.y,n);return e[n-1]|=this.x&ry?128:0,e}toHex(){return tJ(this.toRawBytes())}isTorsionFree(){return f.fromAffine(this).isTorsionFree()}equals(e){if(!(e instanceof w))throw TypeError("Point#equals: expected Point");return this.x===e.x&&this.y===e.y}negate(){return new w(l(-this.x),this.y)}double(){return f.fromAffine(this).double().toAffine()}add(e){return f.fromAffine(this).add(f.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return f.fromAffine(this).multiply(e,this).toAffine()}clearCofactor(){return f.fromAffine(this).clearCofactor().toAffine()}static hashToCurve(e,r){if(!t.mapToCurve)throw Error("No mapToCurve defined for curve");e=t0(e);let i=rf(e,2,{...t.htfDefaults,...r}),{x:n,y:a}=t.mapToCurve(i[0]),{x:s,y:o}=t.mapToCurve(i[1]),l=new w(n,a).add(new w(s,o)).clearCofactor();return l}static encodeToCurve(e,r){if(!t.mapToCurve)throw Error("No mapToCurve defined for curve");e=t0(e);let i=rf(e,1,{...t.htfDefaults,...r}),{x:n,y:a}=t.mapToCurve(i[0]);return new w(n,a).clearCofactor()}}w.BASE=new w(t.Gx,t.Gy),w.ZERO=new w(rd,ry);class b{constructor(e,t){this.r=e,this.s=t,this.assertValidity()}static fromHex(e){let t=t0(e,2*n),r=w.fromHex(t.slice(0,n),!1),i=tX(t.slice(n,2*n));return new b(r,i)}assertValidity(){let{r:e,s:t}=this;if(!(e instanceof w))throw Error("Expected Point instance");return g(t,i,!1),this}toRawBytes(){return t1(this.r.toRawBytes(),tQ(this.s,n))}toHex(){return tJ(this.toRawBytes())}}function g(e,t,r=!0){if(!t)throw TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t){if(r){if(rd<e)return e}else if(rd<=e)return e}throw TypeError("Expected valid scalar: 0 < scalar < max")}function m(e){return function(e){let t=u(e.slice(0,a)),r=e.slice(a,2*a),n=rt(tX(t),i),s=w.BASE.multiply(n),o=s.toRawBytes();return{head:t,prefix:r,scalar:n,point:s,pointBytes:o}}(t.hash(function(e){if((e="bigint"==typeof e||"number"==typeof e?tQ(g(e,s),a):t0(e)).length!==a)throw Error(`Expected ${a} bytes, got ${e.length}`);return e}(e)))}let v=new Uint8Array;function E(e,r=v){return r=t0(r),rt(tX(t.hash(c(e,r,!!t.preHash))),i)}w.BASE._setWindowSize(8);let A={getExtendedPublicKey:m,mod:l,invert:r.invert,hashToPrivateScalar:e=>(function(e,t,r=!1){e=t0(e);let i=t2(t).nByteLength;if(i<16||e.length<i+8||e.length>1024)throw Error("Expected valid bytes of private key as per FIPS 186");let n=r?tX(e):tV(e);return rt(n,t-tG)+tG})(e,i,!0),randomPrivateKey:()=>o(n),precompute(e=8,t=w.BASE){let r=t.equals(w.BASE)?t:new w(t.x,t.y);return r._setWindowSize(e),r.multiply(rp),r}};return{CURVE:t,getPublicKey:function(e){return m(e).pointBytes},sign:function(e,r,n){e=t0(e),t.preHash&&(e=t.preHash(e));let{prefix:a,scalar:s,pointBytes:o}=m(r),l=E(t1(a,e),n),h=w.BASE.multiply(l),u=E(t1(h.toRawBytes(),o,e),n),c=rt(l+u*s,i);return new b(h,c).toRawBytes()},verify:function(e,r,i,n){if(r=t0(r),t.preHash&&(r=t.preHash(r)),i instanceof w);else if(i instanceof Uint8Array||"string"==typeof i)i=w.fromHex(i,!1);else throw Error(`Invalid publicKey: ${i}`);if(e instanceof b)e.assertValidity();else if(e instanceof Uint8Array||"string"==typeof e)e=b.fromHex(e);else throw Error(`Wrong signature: ${e}`);let{r:a,s}=e,o=f.BASE.multiplyUnsafe(s),l=E(t1(a.toRawBytes(),i.toRawBytes(),r),n),h=f.fromAffine(i).multiplyUnsafe(l),u=f.fromAffine(a).add(h);return u.subtract(o).multiplyUnsafe(t.h).equals(f.ZERO)},ExtendedPoint:f,Point:w,Signature:b,utils:A}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let rg=BigInt(0),rm=BigInt(1);function rv(e){let t=function(e){for(let t of["a24"])if("bigint"!=typeof e[t])throw Error(`Invalid curve param ${t}=${e[t]} (${typeof e[t]})`);for(let t of["montgomeryBits","nByteLength"])if(void 0!==e[t]&&!Number.isSafeInteger(e[t]))throw Error(`Invalid curve param ${t}=${e[t]} (${typeof e[t]})`);for(let t of["adjustScalarBytes","domain","powPminus2"])if(void 0!==e[t]&&"function"!=typeof e[t])throw Error(`Invalid ${t} function`);for(let t of["Gu"])if(void 0!==e[t]&&"string"!=typeof e[t])throw Error(`Invalid curve param ${t}=${e[t]} (${typeof e[t]})`);return Object.freeze({...e})}(e),{P:r}=t,i=e=>rt(e,r),n=t.montgomeryBits,a=Math.ceil(n/8),s=t.nByteLength,o=t.adjustScalarBytes||(e=>e),l=t.powPminus2||(e=>rr(e,r-BigInt(2),r));function h(e,t,r=!0){if(!t)throw TypeError("Specify max value");if("number"==typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"==typeof e&&e<t){if(r){if(rg<e)return e}else if(rg<=e)return e}throw TypeError("Expected valid scalar: 0 < scalar < max")}function u(e,t,r){let n=i(e*(t-r));return[t=i(t-n),r=i(r+n)]}function c(e,r){let c=function(e){let t=t0(e,a);return t[s-1]&=127,tX(t)}(r),f=function(e){let t=t0(e);if(t.length!==a&&t.length!==s)throw Error(`Expected ${a} or ${s} bytes, got ${t.length}`);return tX(o(t))}(e),d=function(e,r){let a;let{P:s}=t,o=h(e,s),c=h(r,s),f=t.a24,d=rm,y=rg,p=o,w=rm,b=rg;for(let e=BigInt(n-1);e>=rg;e--){let t=c>>e&rm;b^=t,d=(a=u(b,d,p))[0],p=a[1],y=(a=u(b,y,w))[0],w=a[1],b=t;let r=d+y,n=i(r*r),s=d-y,l=i(s*s),h=n-l,g=p+w,m=p-w,v=i(m*r),E=i(g*s),A=v+E,_=v-E;p=i(A*A),w=i(o*i(_*_)),d=i(n*l),y=i(h*(n+i(f*h)))}d=(a=u(b,d,p))[0],p=a[1],y=(a=u(b,y,w))[0],w=a[1];let g=l(y);return i(d*g)}(c,f);if(d===rg)throw Error("Invalid private or public key received");return tQ(i(d),a)}function f(e){return c(e,t.Gu)}return{scalarMult:c,scalarMultBase:f,getSharedSecret:(e,t)=>c(e,t),getPublicKey:e=>f(e),Gu:t.Gu}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */let rE=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),rA=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),r_=BigInt(0),rS=BigInt(1),rP=BigInt(2),rk=BigInt(5),rx=BigInt(10),rK=BigInt(20),rH=BigInt(40),rU=BigInt(80);function rB(e){let t=e*e%rE*e%rE,r=ri(t,rP,rE)*t%rE,i=ri(r,rS,rE)*e%rE,n=ri(i,rk,rE)*i%rE,a=ri(n,rx,rE)*n%rE,s=ri(a,rK,rE)*a%rE,o=ri(s,rH,rE)*s%rE,l=ri(o,rU,rE)*o%rE,h=ri(l,rU,rE)*o%rE,u=ri(h,rx,rE)*n%rE,c=ri(u,rP,rE)*e%rE;return{pow_p_5_8:c,b2:t}}function rI(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function rO(e,t){let r=rt(t*t*t,rE),i=rt(r*r*t,rE),n=rB(e*i).pow_p_5_8,a=rt(e*r*n,rE),s=rt(t*a*a,rE),o=a,l=rt(a*rA,rE),h=s===e,u=s===rt(-e,rE),c=s===rt(-e*rA,rE);return h&&(a=o),(u||c)&&(a=l),ra(a,rE)&&(a=rt(-a,rE)),{isValid:h||u,value:a}}let rC=ro(rE,void 0,!0),rL=(rC.ORDER+BigInt(3))/BigInt(8),rR=rC.pow(rP,rL),rD=rC.sqrt(rC.negate(rC.ONE)),rj=(rC.ORDER-BigInt(5))/BigInt(8),rz=BigInt(486662),rT=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.negate(r):r}(rC,rC.negate(BigInt(486664))),rW={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:rC,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:eV,randomBytes:eP,adjustScalarBytes:rI,uvRatio:rO,htfDefaults:{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",p:rC.ORDER,m:1,k:128,expand:"xmd",hash:eV},mapToCurve:e=>(function(e){let t,r,i,n,a,s,o,l,h,u,c,f,d,y,p,w,b,g,m,v,E;let{xMn:A,xMd:_,yMn:S,yMd:P}=(t=rC.square(e),t=rC.mul(t,rP),r=rC.add(t,rC.ONE),i=rC.negate(rz),n=rC.square(r),a=rC.mul(n,r),s=rC.mul(t,rz),s=rC.mul(s,i),s=rC.add(s,n),s=rC.mul(s,i),o=rC.square(a),n=rC.square(o),o=rC.mul(o,a),o=rC.mul(o,s),n=rC.mul(n,o),l=rC.pow(n,rj),l=rC.mul(l,o),h=rC.mul(l,rD),n=rC.square(l),n=rC.mul(n,a),u=rC.equals(n,s),c=rC.cmov(h,l,u),f=rC.mul(i,t),d=rC.mul(l,e),d=rC.mul(d,rR),y=rC.mul(d,rD),p=rC.mul(s,t),n=rC.square(d),n=rC.mul(n,a),w=rC.equals(n,p),b=rC.cmov(y,d,w),n=rC.square(c),n=rC.mul(n,a),g=rC.equals(n,s),m=rC.cmov(f,i,g),v=rC.cmov(b,c,g),E=rC.isOdd(v),{xMn:m,xMd:r,yMn:v=rC.cmov(v,rC.negate(v),g!==E),yMd:1n}),k=rC.mul(A,P);k=rC.mul(k,rT);let x=rC.mul(_,S),K=rC.sub(A,_),H=rC.add(A,_),U=rC.mul(x,H),B=rC.equals(U,rC.ZERO);k=rC.cmov(k,rC.ZERO,B),x=rC.cmov(x,rC.ONE,B),K=rC.cmov(K,rC.ONE,B),H=rC.cmov(H,rC.ONE,B);let I=rC.invertBatch([x,H]);return{x:rC.mul(k,I[0]),y:rC.mul(K,I[1])}})(e[0])},rN=rb(rW);function r$(e,t,r){if(t.length>255)throw Error("Context is too big");return eA(ev("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,t.length]),t,e)}rb({...rW,domain:r$}),rb({...rW,domain:r$,preHash:eV});let rM=rv({P:rE,a24:BigInt("121665"),montgomeryBits:255,nByteLength:32,Gu:"0900000000000000000000000000000000000000000000000000000000000000",powPminus2:e=>{let{pow_p_5_8:t,b2:r}=rB(e);return rt(ri(t,BigInt(3),rE)*r,rE)},adjustScalarBytes:rI});function rG(e){if(!(e instanceof r1))throw TypeError("RistrettoPoint expected")}let rF=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),rq=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),rJ=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),rZ=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),rV=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),rX=e=>rO(rS,e),rY=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),rQ=e=>rN.utils.mod(tX(e)&rY);function r0(e){let{d:t}=rN.CURVE,r=rN.CURVE.Fp.ORDER,{mod:i}=rN.utils,n=i(rF*e*e),a=i((n+rS)*rZ),s=BigInt(-1),o=i((s-t*n)*i(n+t)),{isValid:l,value:h}=rO(a,o),u=i(h*e);ra(u,r)||(u=i(-u)),l||(h=u),l||(s=n);let c=i(s*(n-rS)*rV-o),f=h*h,d=i((h+h)*o),y=i(c*rq),p=i(rS-f),w=i(rS+f);return new rN.ExtendedPoint(i(d*w),i(p*y),i(y*w),i(d*p))}class r1{constructor(e){this.ep=e}static hashToCurve(e){e=t0(e,64);let t=rQ(e.slice(0,32)),r=r0(t),i=rQ(e.slice(32,64)),n=r0(i);return new r1(r.add(n))}static fromHex(e){e=t0(e,32);let{a:t,d:r}=rN.CURVE,i=rN.CURVE.Fp.ORDER,{mod:n}=rN.utils,a="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=rQ(e);if(!function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(tQ(s,32),e)||ra(s,i))throw Error(a);let o=n(s*s),l=n(rS+t*o),h=n(rS-t*o),u=n(l*l),c=n(h*h),f=n(t*r*u-c),{isValid:d,value:y}=rX(n(f*c)),p=n(y*h),w=n(y*p*f),b=n((s+s)*p);ra(b,i)&&(b=n(-b));let g=n(l*w),m=n(b*g);if(!d||ra(m,i)||g===r_)throw Error(a);return new r1(new rN.ExtendedPoint(b,g,rS,m))}toRawBytes(){let e,{x:t,y:r,z:i,t:n}=this.ep,a=rN.CURVE.Fp.ORDER,{mod:s}=rN.utils,o=s(s(i+r)*s(i-r)),l=s(t*r),h=s(l*l),{value:u}=rX(s(o*h)),c=s(u*o),f=s(u*l),d=s(c*f*n);if(ra(n*d,a)){let i=s(r*rF),n=s(t*rF);t=i,r=n,e=s(c*rJ)}else e=f;ra(t*d,a)&&(r=s(-r));let y=s((i-r)*e);return ra(y,a)&&(y=s(-y)),tQ(y,32)}toHex(){return tJ(this.toRawBytes())}toString(){return this.toHex()}equals(e){rG(e);let t=this.ep,r=e.ep,{mod:i}=rN.utils,n=i(t.x*r.y)===i(t.y*r.x),a=i(t.y*r.y)===i(t.x*r.x);return n||a}add(e){return rG(e),new r1(this.ep.add(e.ep))}subtract(e){return rG(e),new r1(this.ep.subtract(e.ep))}multiply(e){return new r1(this.ep.multiply(e))}multiplyUnsafe(e){return new r1(this.ep.multiplyUnsafe(e))}}r1.BASE=new r1(rN.ExtendedPoint.BASE),r1.ZERO=new r1(rN.ExtendedPoint.ZERO);let r2="X25519";class r5{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=32,this._nSk=32}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,r){if("raw"!==e)throw Error("Unsupported format");return await this._importKey(t,r)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=rN.utils.randomPrivateKey(),t=new tN(r2,e,"private"),r=await this.derivePublicKey(t);return{publicKey:r,privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(x,B,new Uint8Array(e)),r=await this._hkdf.labeledExpand(t,N,x,this._nSk),i=new tN(r2,new Uint8Array(r),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,r)=>{e.byteLength!==this._nPk?r(Error("Invalid public key for the ciphersuite")):t(new tN(r2,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((r,i)=>{t&&e.byteLength!==this._nPk&&i(Error("Invalid public key for the ciphersuite")),t||e.byteLength===this._nSk||i(Error("Invalid private key for the ciphersuite")),r(new tN(r2,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let r=rM.getPublicKey(e.key);t(new tN(r2,r,"public"))})}_dh(e,t){return new Promise((r,i)=>{try{r(rM.getSharedSecret(e.key,t.key).buffer)}catch(e){i(e)}})}}let[r8,r6,r3]=[[],[],[]],r4=BigInt(0),r9=BigInt(1),r7=BigInt(2),ie=BigInt(7),it=BigInt(256),ir=BigInt(113);for(let e=0,t=r9,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],r8.push(2*(5*i+r)),r6.push((e+1)*(e+2)/2%64);let n=r4;for(let e=0;e<7;e++)(t=(t<<r9^(t>>ie)*ir)%it)&r7&&(n^=r9<<(r9<<BigInt(e))-r9);r3.push(n)}let[ii,ia]=eW.split(r3,!0),is=(e,t,r)=>r>32?eW.rotlBH(e,t,r):eW.rotlSH(e,t,r),io=(e,t,r)=>r>32?eW.rotlBL(e,t,r):eW.rotlSL(e,t,r);class il extends e_{constructor(e,t,r,i=!1,n=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=n,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,ey.number(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=ew(this.state)}keccak(){!function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,n=(t+2)%10,a=r[n],s=r[n+1],o=is(a,s,1)^r[i],l=io(a,s,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=o,e[t+r+1]^=l}let t=e[2],n=e[3];for(let r=0;r<24;r++){let i=r6[r],a=is(t,n,i),s=io(t,n,i),o=r8[r];t=e[o],n=e[o+1],e[o]=a,e[o+1]=s}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=ii[i],e[1]^=ia[i]}r.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}update(e){ey.exists(this);let{blockLen:t,state:r}=this;e=eE(e);let i=e.length;for(let n=0;n<i;){let a=Math.min(t-this.pos,i-n);for(let t=0;t<a;t++)r[this.pos++]^=e[n++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){ey.exists(this,!1),ey.bytes(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,n=e.length;i<n;){this.posOut>=r&&this.keccak();let a=Math.min(r-this.posOut,n-i);e.set(t.subarray(this.posOut,this.posOut+a),i),this.posOut+=a,i+=a}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return ey.number(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(ey.output(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:n,enableXOF:a}=this;return e||(e=new il(t,r,i,a,n)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=n,e.suffix=r,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}let ih=(e,t,r)=>eS(()=>new il(t,e,r));ih(6,144,28),ih(6,136,32),ih(6,104,48),ih(6,72,64),ih(1,144,28),ih(1,136,32),ih(1,104,48),ih(1,72,64);let iu=(e,t,r)=>(function(e){let t=(t,r)=>e(r).update(eE(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t})((i={})=>new il(t,e,void 0===i.dkLen?r:i.dkLen,!0));iu(31,168,16);let ic=iu(31,136,32),id=eS(()=>ic.create({dkLen:114})),iy=eS(()=>ic.create({dkLen:64})),ip=BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439");function iw(e){let t=BigInt(1),r=BigInt(2),i=BigInt(3),n=BigInt(11),a=BigInt(22),s=BigInt(44),o=BigInt(88),l=BigInt(223),h=e*e*e%ip,u=h*h*e%ip,c=ri(u,i,ip)*u%ip,f=ri(c,i,ip)*u%ip,d=ri(f,r,ip)*h%ip,y=ri(d,n,ip)*d%ip,p=ri(y,a,ip)*y%ip,w=ri(p,s,ip)*p%ip,b=ri(w,o,ip)*w%ip,g=ri(b,s,ip)*p%ip,m=ri(g,r,ip)*h%ip,v=ri(m,t,ip)*e%ip;return ri(v,l,ip)*m%ip}function ib(e){return e[0]&=252,e[55]|=128,e[56]=0,e}let ig=ro(ip,456,!0),im=(ig.ORDER-BigInt(3))/BigInt(4),iv=BigInt(156326),iE={a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:ig,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:id,randomBytes:eP,adjustScalarBytes:ib,domain:(e,t,r)=>{if(t.length>255)throw Error(`Context is too big: ${t.length}`);return eA(ev("SigEd448"),new Uint8Array([r?1:0,t.length]),t,e)},uvRatio:(e,t)=>{let r=rt(e*e*t,ip),i=rt(r*e,ip),n=rt(i*r*t,ip),a=iw(n),s=rt(i*a,ip),o=rt(s*s,ip);return{isValid:rt(o*t,ip)===e,value:s}},htfDefaults:{DST:"edwards448_XOF:SHAKE256_ELL2_RO_",p:ig.ORDER,m:1,k:224,expand:"xof",hash:ic},mapToCurve:e=>(function(e){let t,r,i,n,a,s,o,l,h,u,c,f,d,y,p;let{xn:w,xd:b,yn:g,yd:m}=(t=ig.square(e),r=ig.equals(t,ig.ONE),t=ig.cmov(t,ig.ZERO,r),i=ig.sub(ig.ONE,t),n=ig.negate(iv),a=ig.square(i),s=ig.mul(a,i),o=ig.mul(t,ig.negate(iv)),o=ig.mul(o,n),o=ig.add(o,a),o=ig.mul(o,n),l=ig.square(s),a=ig.mul(o,s),l=ig.mul(l,a),h=ig.pow(l,im),h=ig.mul(h,a),u=ig.mul(n,ig.negate(t)),c=ig.mul(h,e),c=ig.cmov(c,ig.ZERO,r),a=ig.square(h),a=ig.mul(a,s),f=ig.equals(a,o),d=ig.cmov(u,n,f),y=ig.cmov(c,h,f),p=ig.isOdd(y),{xn:d,xd:i,yn:y=ig.cmov(y,ig.negate(y),f!==p),yd:ig.ONE}),v=ig.square(w),E=ig.square(b),A=ig.square(E),_=ig.square(g),S=ig.square(m),P=ig.sub(v,E),k=ig.sub(P,E);P=ig.mul(P,E),P=ig.mul(P,m),P=ig.mul(P,g),P=ig.mul(P,4n),k=ig.mul(k,v),k=ig.mul(k,S);let x=ig.mul(_,4n),K=ig.add(x,S);K=ig.mul(K,A);let H=ig.add(K,k);k=ig.mul(k,w);let U=ig.mul(w,A),B=ig.sub(x,S);B=ig.mul(B,U),B=ig.sub(B,k),K=ig.add(v,E),K=ig.mul(K,E),K=ig.mul(K,b),K=ig.mul(K,_),K=ig.mul(K,BigInt(-2));let I=ig.add(k,K);U=ig.mul(U,S),I=ig.add(I,U),K=ig.mul(H,I);let O=ig.equals(K,ig.ZERO);P=ig.cmov(P,ig.ZERO,O),H=ig.cmov(H,ig.ONE,O),B=ig.cmov(B,ig.ONE,O),I=ig.cmov(I,ig.ONE,O);let C=ig.invertBatch([H,I]);return{x:ig.mul(P,C[0]),y:ig.mul(B,C[1])}})(e[0])},iA=rb(iE);rb({...iE,preHash:iy});let i_=rv({a24:BigInt(39081),montgomeryBits:448,nByteLength:57,P:ip,Gu:"0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",powPminus2:e=>{let t=iw(e),r=ri(t,BigInt(2),ip);return rt(r*e,ip)},adjustScalarBytes:ib}),iS="X448";class iP{constructor(e){Object.defineProperty(this,"_hkdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nPk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nSk",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._hkdf=e,this._nPk=56,this._nSk=56}async serializePublicKey(e){return await this._serializePublicKey(e)}async deserializePublicKey(e){return await this._deserializePublicKey(e)}async importKey(e,t,r){if("raw"!==e)throw Error("Unsupported format");return await this._importKey(t,r)}async derivePublicKey(e){return await this._derivePublicKey(e)}async generateKeyPair(){let e=iA.utils.randomPrivateKey(),t=new tN(iS,e,"private"),r=await this.derivePublicKey(t);return{publicKey:r,privateKey:t}}async deriveKeyPair(e){let t=await this._hkdf.labeledExtract(x,B,new Uint8Array(e)),r=await this._hkdf.labeledExpand(t,N,x,this._nSk),i=new tN(iS,new Uint8Array(r),"private");return{privateKey:i,publicKey:await this.derivePublicKey(i)}}async dh(e,t){return await this._dh(e,t)}_serializePublicKey(e){return new Promise(t=>{t(e.key.buffer)})}_deserializePublicKey(e){return new Promise((t,r)=>{e.byteLength!==this._nPk?r(Error("Invalid public key for the ciphersuite")):t(new tN(iS,new Uint8Array(e),"public"))})}_importKey(e,t){return new Promise((r,i)=>{t&&e.byteLength!==this._nPk&&i(Error("Invalid public key for the ciphersuite")),t||e.byteLength===this._nSk||i(Error("Invalid private key for the ciphersuite")),r(new tN(iS,new Uint8Array(e),t?"public":"private"))})}_derivePublicKey(e){return new Promise(t=>{let r=i_.getPublicKey(e.key);t(new tN(iS,r,"public"))})}_dh(e,t){return new Promise((r,i)=>{try{r(i_.getSharedSecret(e.key,t.key).buffer)}catch(e){i(e)}})}}class ik extends _{constructor(e,t,r){super(e),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_prim",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._prim=t,this._kdf=r}async generateKeyPair(){try{return await this._prim.generateKeyPair()}catch(e){throw new w(e)}}async deriveKeyPair(e){try{return await this._prim.deriveKeyPair(e)}catch(e){throw new p(e)}}async serializePublicKey(e){try{return await this._prim.serializePublicKey(e)}catch(e){throw new o(e)}}async deserializePublicKey(e){try{return await this._prim.deserializePublicKey(e)}catch(e){throw new l(e)}}async importKey(e,t,r){try{return await this._prim.importKey(e,t,r)}catch(e){throw new l(e)}}async encap(e){try{let t,r;let i=void 0===e.nonEphemeralKeyPair?await this.generateKeyPair():e.nonEphemeralKeyPair,n=await this._prim.serializePublicKey(i.publicKey),a=await this._prim.serializePublicKey(e.recipientPublicKey);if(void 0===e.senderKey)t=new Uint8Array(await this._prim.dh(i.privateKey,e.recipientPublicKey));else{let r=v(e.senderKey)?e.senderKey.privateKey:e.senderKey,n=new Uint8Array(await this._prim.dh(i.privateKey,e.recipientPublicKey)),a=new Uint8Array(await this._prim.dh(r,e.recipientPublicKey));t=A(n,a)}if(void 0===e.senderKey)r=A(new Uint8Array(n),new Uint8Array(a));else{let t=v(e.senderKey)?e.senderKey.publicKey:await this._prim.derivePublicKey(e.senderKey),i=await this._prim.serializePublicKey(t);r=function(e,t,r){let i=new Uint8Array(e.length+t.length+r.length);return i.set(e,0),i.set(t,e.length),i.set(r,e.length+t.length),i}(new Uint8Array(n),new Uint8Array(a),new Uint8Array(i))}let s=await this.generateSharedSecret(t,r);return{enc:n,sharedSecret:s}}catch(e){throw new h(e)}}async decap(e){let t;try{t=await this._prim.deserializePublicKey(e.enc)}catch(e){throw new l(e)}try{let r,i;let n=v(e.recipientKey)?e.recipientKey.privateKey:e.recipientKey,a=v(e.recipientKey)?e.recipientKey.publicKey:await this._prim.derivePublicKey(e.recipientKey),s=await this._prim.serializePublicKey(a);if(void 0===e.senderPublicKey)r=new Uint8Array(await this._prim.dh(n,t));else{let i=new Uint8Array(await this._prim.dh(n,t)),a=new Uint8Array(await this._prim.dh(n,e.senderPublicKey));r=A(i,a)}if(void 0===e.senderPublicKey)i=A(new Uint8Array(e.enc),new Uint8Array(s));else{let t=await this._prim.serializePublicKey(e.senderPublicKey);(i=new Uint8Array(e.enc.byteLength+s.byteLength+t.byteLength)).set(new Uint8Array(e.enc),0),i.set(new Uint8Array(s),e.enc.byteLength),i.set(new Uint8Array(t),e.enc.byteLength+s.byteLength)}return await this.generateSharedSecret(r,i)}catch(e){throw new u(e)}}async generateSharedSecret(e,t){let r=this._kdf.buildLabeledIkm(I,e),i=this._kdf.buildLabeledInfo(R,t,this.secretSize);return await this._kdf.extractAndExpand(x,r,i,this.secretSize)}}class ix extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemP256HkdfSha256,2),3);let r=new eQ(e,t),i=new e9(ea.DhkemP256HkdfSha256,r,e);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemP256HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}}class iK extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemP384HkdfSha384,2),3);let r=new e0(e,t),i=new e9(ea.DhkemP384HkdfSha384,r,e);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemP384HkdfSha384}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:48}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:97}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:48})}}class iH extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemP521HkdfSha512,2),3);let r=new e1(e,t),i=new e9(ea.DhkemP521HkdfSha512,r,e);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemP521HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:133}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:64})}}class iU extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemSecp256K1HkdfSha256,2),3);let r=new eQ(e,t),i=new tM(r);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemSecp256K1HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:65}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}}class iB extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemX25519HkdfSha256,2),3);let r=new eQ(e,t),i=new r5(r);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemX25519HkdfSha256}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:32})}}class iI extends ik{constructor(e){let t=new Uint8Array(U);t.set(E(ea.DhkemX448HkdfSha512,2),3);let r=new e1(e,t),i=new iP(r);super(e,i,r),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:ea.DhkemX448HkdfSha512}),Object.defineProperty(this,"secretSize",{enumerable:!0,configurable:!0,writable:!0,value:64}),Object.defineProperty(this,"encSize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"publicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56}),Object.defineProperty(this,"privateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:56})}}class iO{constructor(e){switch(Object.defineProperty(this,"kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"aead",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kemSecretSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemEncSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPublicKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"kemPrivateKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadKeySize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadNonceSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"aeadTagSize",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_api",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_kdf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_suiteId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e.kem){case ea.DhkemP256HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case ea.DhkemP384HkdfSha384:this.kemSecretSize=48,this.kemEncSize=97,this.kemPublicKeySize=97,this.kemPrivateKeySize=48;break;case ea.DhkemP521HkdfSha512:this.kemSecretSize=64,this.kemEncSize=133,this.kemPublicKeySize=133,this.kemPrivateKeySize=66;break;case ea.DhkemSecp256K1HkdfSha256:this.kemSecretSize=32,this.kemEncSize=65,this.kemPublicKeySize=65,this.kemPrivateKeySize=32;break;case ea.DhkemX25519HkdfSha256:this.kemSecretSize=32,this.kemEncSize=32,this.kemPublicKeySize=32,this.kemPrivateKeySize=32;break;case ea.DhkemX448HkdfSha512:this.kemSecretSize=64,this.kemEncSize=56,this.kemPublicKeySize=56,this.kemPrivateKeySize=56;break;default:throw new s("Invalid KEM id")}switch(this.kem=e.kem,e.kdf){case es.HkdfSha256:case es.HkdfSha384:case es.HkdfSha512:break;default:throw new s("Invalid KDF id")}switch(this.kdf=e.kdf,e.aead){case eo.Aes128Gcm:this.aeadKeySize=16,this.aeadNonceSize=12,this.aeadTagSize=16;break;case eo.Aes256Gcm:case eo.Chacha20Poly1305:this.aeadKeySize=32,this.aeadNonceSize=12,this.aeadTagSize=16;break;case eo.ExportOnly:break;default:throw new s("Invalid AEAD id")}this.aead=e.aead,this._suiteId=new Uint8Array(H),this._suiteId.set(E(this.kem,2),4),this._suiteId.set(E(this.kdf,2),6),this._suiteId.set(E(this.aead,2),8)}async kemContext(){return await this.setup(),this._kem}async kdfContext(){return await this.setup(),this._kdf}async createAeadKey(e){return await this.setup(),ec(this.aead,e,this._api)}async generateKeyPair(){return await this.setup(),await this._kem.generateKeyPair()}async deriveKeyPair(e){if(e.byteLength>128)throw new s("Too long ikm");return await this.setup(),await this._kem.deriveKeyPair(e)}async importKey(e,t,r=!0){return await this.setup(),await this._kem.importKey(e,t,r)}async createSenderContext(e){let t;this.validateInputLength(e),await this.setup();let r=await this._kem.encap(e);return t=void 0!==e.psk?void 0!==e.senderKey?en.AuthPsk:en.Psk:void 0!==e.senderKey?en.Auth:en.Base,await this.keyScheduleS(t,r.sharedSecret,r.enc,e)}async createRecipientContext(e){let t;this.validateInputLength(e),await this.setup();let r=await this._kem.decap(e);return t=void 0!==e.psk?void 0!==e.senderPublicKey?en.AuthPsk:en.Psk:void 0!==e.senderPublicKey?en.Auth:en.Base,await this.keyScheduleR(t,r,e)}async seal(e,t,r=x){let i=await this.createSenderContext(e);return{ct:await i.seal(t,r),enc:i.enc}}async open(e,t,r=x){let i=await this.createRecipientContext(e);return await i.open(t,r)}async setup(){this._api=await S(),(void 0===this._kem||void 0===this._kdf)&&(this._kem=this.createKemContext(),this._kdf=this.createKdfContext())}async keySchedule(e,t,r){let i=this.createKdfContext(),n=void 0===r.psk?x:new Uint8Array(r.psk.id),a=await i.labeledExtract(x,C,n),s=void 0===r.info?x:new Uint8Array(r.info),o=await i.labeledExtract(x,O,s),l=new Uint8Array(1+a.byteLength+o.byteLength);l.set(new Uint8Array([e]),0),l.set(new Uint8Array(a),1),l.set(new Uint8Array(o),1+a.byteLength);let h=void 0===r.psk?x:new Uint8Array(r.psk.key),u=i.buildLabeledIkm(L,h),c=i.buildLabeledInfo(z,l,i.hashSize),f=await i.extractAndExpand(t,u,c,i.hashSize);if(this.aead===eo.ExportOnly)return{params:{aead:this.aead,exporterSecret:f},kdf:i};let d=i.buildLabeledInfo(D,l,this.aeadKeySize),y=await i.extractAndExpand(t,u,d,this.aeadKeySize),p=i.buildLabeledInfo(j,l,this.aeadNonceSize),w=await i.extractAndExpand(t,u,p,this.aeadNonceSize);return{params:{aead:this.aead,exporterSecret:f,key:y,baseNonce:new Uint8Array(w),seq:0},kdf:i}}async keyScheduleS(e,t,r,i){let n=await this.keySchedule(e,t,i);return void 0===n.params.key?new J(this._api,n.kdf,n.params.exporterSecret,r):new e5(this._api,n.kdf,n.params,r)}async keyScheduleR(e,t,r){let i=await this.keySchedule(e,t,r);return void 0===i.params.key?new q(this._api,i.kdf,i.params.exporterSecret):new e2(this._api,i.kdf,i.params)}validateInputLength(e){if(void 0!==e.info&&e.info.byteLength>128)throw new s("Too long info");if(void 0!==e.psk){if(e.psk.key.byteLength<32)throw new s("PSK must have at least 32 bytes");if(e.psk.key.byteLength>128)throw new s("Too long psk.key");if(e.psk.id.byteLength>128)throw new s("Too long psk.id")}}createKemContext(){switch(this.kem){case ea.DhkemP256HkdfSha256:return new ix(this._api);case ea.DhkemP384HkdfSha384:return new iK(this._api);case ea.DhkemP521HkdfSha512:return new iH(this._api);case ea.DhkemX25519HkdfSha256:return new iB(this._api);case ea.DhkemX448HkdfSha512:return new iI(this._api);default:return new iU(this._api)}}createKdfContext(){switch(this.kdf){case es.HkdfSha256:return new eQ(this._api,this._suiteId);case es.HkdfSha384:return new e0(this._api,this._suiteId);default:return new e1(this._api,this._suiteId)}}}},3671:function(e,t,r){"use strict";r.d(t,{aL:function(){return eK},tH:function(){return i},d3:function(){return eP},TA:function(){return e_},Au:function(){return eO},nO:function(){return ec}});var i={};r.r(i),r.d(i,{decode:function(){return eU},encode:function(){return eH}});var n=crypto;let a=e=>e instanceof CryptoKey,s=async(e,t)=>{let r=`SHA-${e.slice(-3)}`;return new Uint8Array(await n.subtle.digest(r,t))},o=new TextEncoder,l=new TextDecoder;function h(...e){let t=e.reduce((e,{length:t})=>e+t,0),r=new Uint8Array(t),i=0;return e.forEach(e=>{r.set(e,i),i+=e.length}),r}function u(e,t,r){if(t<0||t>=4294967296)throw RangeError(`value must be >= 0 and <= ${4294967296-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,255&t],r)}function c(e){let t=new Uint8Array(8);return u(t,Math.floor(e/4294967296),0),u(t,e%4294967296,4),t}function f(e){let t=new Uint8Array(4);return u(t,e),t}function d(e){return h(f(e.length),e)}async function y(e,t,r){let i=Math.ceil((t>>3)/32),n=new Uint8Array(32*i);for(let t=0;t<i;t++){let i=new Uint8Array(4+e.length+r.length);i.set(f(t+1)),i.set(e,4),i.set(r,4+e.length),n.set(await s("sha256",i),32*t)}return n.slice(0,t>>3)}let p=e=>{let t=e;"string"==typeof t&&(t=o.encode(t));let r=[];for(let e=0;e<t.length;e+=32768)r.push(String.fromCharCode.apply(null,t.subarray(e,e+32768)));return btoa(r.join(""))},w=e=>p(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"),b=e=>{let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r},g=e=>{let t=e;t instanceof Uint8Array&&(t=l.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"");try{return b(t)}catch(e){throw TypeError("The input to be decoded is not correctly encoded.")}};class m extends Error{static get code(){return"ERR_JOSE_GENERIC"}constructor(e){var t;super(e),this.code="ERR_JOSE_GENERIC",this.name=this.constructor.name,null===(t=Error.captureStackTrace)||void 0===t||t.call(Error,this,this.constructor)}}class v extends m{constructor(){super(...arguments),this.code="ERR_JOSE_ALG_NOT_ALLOWED"}static get code(){return"ERR_JOSE_ALG_NOT_ALLOWED"}}class E extends m{constructor(){super(...arguments),this.code="ERR_JOSE_NOT_SUPPORTED"}static get code(){return"ERR_JOSE_NOT_SUPPORTED"}}class A extends m{constructor(){super(...arguments),this.code="ERR_JWE_DECRYPTION_FAILED",this.message="decryption operation failed"}static get code(){return"ERR_JWE_DECRYPTION_FAILED"}}class _ extends m{constructor(){super(...arguments),this.code="ERR_JWE_INVALID"}static get code(){return"ERR_JWE_INVALID"}}var S=n.getRandomValues.bind(n);function P(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new E(`Unsupported JWE Algorithm: ${e}`)}}var k=e=>S(new Uint8Array(P(e)>>3));let x=(e,t)=>{if(t.length<<3!==P(e))throw new _("Invalid Initialization Vector length")},K=(e,t)=>{let r=e.byteLength<<3;if(r!==t)throw new _(`Invalid Content Encryption Key length. Expected ${t} bits, got ${r} bits`)},H=(e,t)=>{if(!(e instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw TypeError("Second argument must be a buffer");if(e.length!==t.length)throw TypeError("Input buffers must have the same length");let r=e.length,i=0,n=-1;for(;++n<r;)i|=e[n]^t[n];return 0===i};function U(e,t="algorithm.name"){return TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`)}function B(e,t){return e.name===t}function I(e,t,...r){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!B(e.algorithm,"AES-GCM"))throw U("AES-GCM");let r=parseInt(t.slice(1,4),10),i=e.algorithm.length;if(i!==r)throw U(r,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!B(e.algorithm,"AES-KW"))throw U("AES-KW");let r=parseInt(t.slice(1,4),10),i=e.algorithm.length;if(i!==r)throw U(r,"algorithm.length");break}case"ECDH":switch(e.algorithm.name){case"ECDH":case"X25519":case"X448":break;default:throw U("ECDH, X25519, or X448")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!B(e.algorithm,"PBKDF2"))throw U("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!B(e.algorithm,"RSA-OAEP"))throw U("RSA-OAEP");let r=parseInt(t.slice(9),10)||1,i=parseInt(e.algorithm.hash.name.slice(4),10);if(i!==r)throw U(`SHA-${r}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}!function(e,t){if(t.length&&!t.some(t=>e.usages.includes(t))){let e="CryptoKey does not support this operation, its usages must include ";if(t.length>2){let r=t.pop();e+=`one of ${t.join(", ")}, or ${r}.`}else 2===t.length?e+=`one of ${t[0]} or ${t[1]}.`:e+=`${t[0]}.`;throw TypeError(e)}}(e,r)}function O(e,t,...r){if(r.length>2){let t=r.pop();e+=`one of type ${r.join(", ")}, or ${t}.`}else 2===r.length?e+=`one of type ${r[0]} or ${r[1]}.`:e+=`of type ${r[0]}.`;return null==t?e+=` Received ${t}`:"function"==typeof t&&t.name?e+=` Received function ${t.name}`:"object"==typeof t&&null!=t&&t.constructor&&t.constructor.name&&(e+=` Received an instance of ${t.constructor.name}`),e}var C=(e,...t)=>O("Key must be ",e,...t);function L(e,t,...r){return O(`Key for the ${e} algorithm must be `,t,...r)}var R=e=>a(e);let D=["CryptoKey"];async function j(e,t,r,i,a,s){let o,l;if(!(t instanceof Uint8Array))throw TypeError(C(t,"Uint8Array"));let u=parseInt(e.slice(1,4),10),f=await n.subtle.importKey("raw",t.subarray(u>>3),"AES-CBC",!1,["decrypt"]),d=await n.subtle.importKey("raw",t.subarray(0,u>>3),{hash:`SHA-${u<<1}`,name:"HMAC"},!1,["sign"]),y=h(s,i,r,c(s.length<<3)),p=new Uint8Array((await n.subtle.sign("HMAC",d,y)).slice(0,u>>3));try{o=H(a,p)}catch(e){}if(!o)throw new A;try{l=new Uint8Array(await n.subtle.decrypt({iv:i,name:"AES-CBC"},f,r))}catch(e){}if(!l)throw new A;return l}async function z(e,t,r,i,a,s){let o;t instanceof Uint8Array?o=await n.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(I(t,e,"decrypt"),o=t);try{return new Uint8Array(await n.subtle.decrypt({additionalData:s,iv:i,name:"AES-GCM",tagLength:128},o,h(r,a)))}catch(e){throw new A}}let T=async(e,t,r,i,n,s)=>{if(!a(t)&&!(t instanceof Uint8Array))throw TypeError(C(t,...D,"Uint8Array"));switch(x(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&K(t,parseInt(e.slice(-3),10)),j(e,t,r,i,n,s);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&K(t,parseInt(e.slice(1,4),10)),z(e,t,r,i,n,s);default:throw new E("Unsupported JWE Content Encryption Algorithm")}},W=async()=>{throw new E('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `inflateRaw` decrypt option to provide Inflate Raw implementation.')},N=async()=>{throw new E('JWE "zip" (Compression Algorithm) Header Parameter is not supported by your javascript runtime. You need to use the `deflateRaw` encrypt option to provide Deflate Raw implementation.')},$=(...e)=>{let t;let r=e.filter(Boolean);if(0===r.length||1===r.length)return!0;for(let e of r){let r=Object.keys(e);if(!t||0===t.size){t=new Set(r);continue}for(let e of r){if(t.has(e))return!1;t.add(e)}}return!0};function M(e){if(!("object"==typeof e&&null!==e)||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var G=[{hash:"SHA-256",name:"HMAC"},!0,["sign"]];function F(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${t}`)}function q(e,t,r){if(a(e))return I(e,t,r),e;if(e instanceof Uint8Array)return n.subtle.importKey("raw",e,"AES-KW",!0,[r]);throw TypeError(C(e,...D,"Uint8Array"))}let J=async(e,t,r)=>{let i=await q(t,e,"wrapKey");F(i,e);let a=await n.subtle.importKey("raw",r,...G);return new Uint8Array(await n.subtle.wrapKey("raw",a,i,"AES-KW"))},Z=async(e,t,r)=>{let i=await q(t,e,"unwrapKey");F(i,e);let a=await n.subtle.unwrapKey("raw",r,i,"AES-KW",...G);return new Uint8Array(await n.subtle.exportKey("raw",a))};async function V(e,t,r,i,s=new Uint8Array(0),l=new Uint8Array(0)){let u;if(!a(e))throw TypeError(C(e,...D));if(I(e,"ECDH"),!a(t))throw TypeError(C(t,...D));I(t,"ECDH","deriveBits");let c=h(d(o.encode(r)),d(s),d(l),f(i));u="X25519"===e.algorithm.name?256:"X448"===e.algorithm.name?448:Math.ceil(parseInt(e.algorithm.namedCurve.substr(-3),10)/8)<<3;let p=new Uint8Array(await n.subtle.deriveBits({name:e.algorithm.name,public:e},t,u));return y(p,i,c)}async function X(e){if(!a(e))throw TypeError(C(e,...D));return n.subtle.generateKey(e.algorithm,!0,["deriveBits"])}function Y(e){if(!a(e))throw TypeError(C(e,...D));return["P-256","P-384","P-521"].includes(e.algorithm.namedCurve)||"X25519"===e.algorithm.name||"X448"===e.algorithm.name}async function Q(e,t,r,i){!function(e){if(!(e instanceof Uint8Array)||e.length<8)throw new _("PBES2 Salt Input must be 8 or more octets")}(e);let s=h(o.encode(t),new Uint8Array([0]),e),l=parseInt(t.slice(13,16),10),u={hash:`SHA-${t.slice(8,11)}`,iterations:r,name:"PBKDF2",salt:s},c=await function(e,t){if(e instanceof Uint8Array)return n.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]);if(a(e))return I(e,t,"deriveBits","deriveKey"),e;throw TypeError(C(e,...D,"Uint8Array"))}(i,t);if(c.usages.includes("deriveBits"))return new Uint8Array(await n.subtle.deriveBits(u,c,l));if(c.usages.includes("deriveKey"))return n.subtle.deriveKey(u,c,{length:l,name:"AES-KW"},!1,["wrapKey","unwrapKey"]);throw TypeError('PBKDF2 key "usages" must include "deriveBits" or "deriveKey"')}let ee=async(e,t,r,i=2048,n=S(new Uint8Array(16)))=>{let a=await Q(n,e,i,t),s=await J(e.slice(-6),a,r);return{encryptedKey:s,p2c:i,p2s:w(n)}},et=async(e,t,r,i,n)=>{let a=await Q(n,e,i,t);return Z(e.slice(-6),a,r)};function er(e){switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new E(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}var ei=(e,t)=>{if(e.startsWith("RS")||e.startsWith("PS")){let{modulusLength:r}=t.algorithm;if("number"!=typeof r||r<2048)throw TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}};let en=async(e,t,r)=>{if(!a(t))throw TypeError(C(t,...D));if(I(t,e,"encrypt","wrapKey"),ei(e,t),t.usages.includes("encrypt"))return new Uint8Array(await n.subtle.encrypt(er(e),t,r));if(t.usages.includes("wrapKey")){let i=await n.subtle.importKey("raw",r,...G);return new Uint8Array(await n.subtle.wrapKey("raw",i,t,er(e)))}throw TypeError('RSA-OAEP key "usages" must include "encrypt" or "wrapKey" for this operation')},ea=async(e,t,r)=>{if(!a(t))throw TypeError(C(t,...D));if(I(t,e,"decrypt","unwrapKey"),ei(e,t),t.usages.includes("decrypt"))return new Uint8Array(await n.subtle.decrypt(er(e),t,r));if(t.usages.includes("unwrapKey")){let i=await n.subtle.unwrapKey("raw",r,t,er(e),...G);return new Uint8Array(await n.subtle.exportKey("raw",i))}throw TypeError('RSA-OAEP key "usages" must include "decrypt" or "unwrapKey" for this operation')};function es(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new E(`Unsupported JWE Algorithm: ${e}`)}}var eo=e=>S(new Uint8Array(es(e)>>3));let el=(e,t,r=0)=>{0===r&&(t.unshift(t.length),t.unshift(6));let i=e.indexOf(t[0],r);if(-1===i)return!1;let n=e.subarray(i,i+t.length);return n.length===t.length&&(n.every((e,r)=>e===t[r])||el(e,t,i+1))};function eh(){return"undefined"!=typeof WebSocketPair||"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||"undefined"!=typeof EdgeRuntime&&"vercel"===EdgeRuntime}let eu=async e=>{var t,r;if(!e.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:i,keyUsages:a}=function(e){let t,r;switch(e.kty){case"oct":switch(e.alg){case"HS256":case"HS384":case"HS512":t={name:"HMAC",hash:`SHA-${e.alg.slice(-3)}`},r=["sign","verify"];break;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":throw new E(`${e.alg} keys cannot be imported as CryptoKey instances`);case"A128GCM":case"A192GCM":case"A256GCM":case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":t={name:"AES-GCM"},r=["encrypt","decrypt"];break;case"A128KW":case"A192KW":case"A256KW":t={name:"AES-KW"},r=["wrapKey","unwrapKey"];break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":t={name:"PBKDF2"},r=["deriveBits"];break;default:throw new E('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},r=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},r=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new E('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},r=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},r=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new E('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(e.alg){case"EdDSA":t={name:e.crv},r=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},r=e.d?["deriveBits"]:[];break;default:throw new E('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new E('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:r}}(e),s=[i,null!==(t=e.ext)&&void 0!==t&&t,null!==(r=e.key_ops)&&void 0!==r?r:a];if("PBKDF2"===i.name)return n.subtle.importKey("raw",g(e.k),...s);let o={...e};delete o.alg,delete o.use;try{return await n.subtle.importKey("jwk",o,...s)}catch(e){if("Ed25519"===i.name&&(null==e?void 0:e.name)==="NotSupportedError"&&eh())return s[0]={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},await n.subtle.importKey("jwk",o,...s);throw e}};async function ec(e,t,r){var i;if(!M(e))throw TypeError("JWK must be an object");switch(t||(t=e.alg),e.kty){case"oct":if("string"!=typeof e.k||!e.k)throw TypeError('missing "k" (Key Value) Parameter value');if(null!=r||(r=!0!==e.ext),r)return eu({...e,alg:t,ext:null!==(i=e.ext)&&void 0!==i&&i});return g(e.k);case"RSA":if(void 0!==e.oth)throw new E('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');case"EC":case"OKP":return eu({...e,alg:t});default:throw new E('Unsupported "kty" (Key Type) Parameter value')}}let ef=(e,t)=>{if(!(t instanceof Uint8Array)){if(!R(t))throw TypeError(L(e,t,...D,"Uint8Array"));if("secret"!==t.type)throw TypeError(`${D.join(" or ")} instances for symmetric algorithms must be of type "secret"`)}},ed=(e,t,r)=>{if(!R(t))throw TypeError(L(e,t,...D));if("secret"===t.type)throw TypeError(`${D.join(" or ")} instances for asymmetric algorithms must not be of type "secret"`);if("sign"===r&&"public"===t.type)throw TypeError(`${D.join(" or ")} instances for asymmetric algorithm signing must be of type "private"`);if("decrypt"===r&&"public"===t.type)throw TypeError(`${D.join(" or ")} instances for asymmetric algorithm decryption must be of type "private"`);if(t.algorithm&&"verify"===r&&"private"===t.type)throw TypeError(`${D.join(" or ")} instances for asymmetric algorithm verifying must be of type "public"`);if(t.algorithm&&"encrypt"===r&&"private"===t.type)throw TypeError(`${D.join(" or ")} instances for asymmetric algorithm encryption must be of type "public"`)},ey=(e,t,r)=>{let i=e.startsWith("HS")||"dir"===e||e.startsWith("PBES2")||/^A\d{3}(?:GCM)?KW$/.test(e);i?ef(e,t):ed(e,t,r)};async function ep(e,t,r,i,a){if(!(r instanceof Uint8Array))throw TypeError(C(r,"Uint8Array"));let s=parseInt(e.slice(1,4),10),o=await n.subtle.importKey("raw",r.subarray(s>>3),"AES-CBC",!1,["encrypt"]),l=await n.subtle.importKey("raw",r.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),u=new Uint8Array(await n.subtle.encrypt({iv:i,name:"AES-CBC"},o,t)),f=h(a,i,u,c(a.length<<3)),d=new Uint8Array((await n.subtle.sign("HMAC",l,f)).slice(0,s>>3));return{ciphertext:u,tag:d}}async function ew(e,t,r,i,a){let s;r instanceof Uint8Array?s=await n.subtle.importKey("raw",r,"AES-GCM",!1,["encrypt"]):(I(r,e,"encrypt"),s=r);let o=new Uint8Array(await n.subtle.encrypt({additionalData:a,iv:i,name:"AES-GCM",tagLength:128},s,t)),l=o.slice(-16),h=o.slice(0,-16);return{ciphertext:h,tag:l}}let eb=async(e,t,r,i,n)=>{if(!a(r)&&!(r instanceof Uint8Array))throw TypeError(C(r,...D,"Uint8Array"));switch(x(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return r instanceof Uint8Array&&K(r,parseInt(e.slice(-3),10)),ep(e,t,r,i,n);case"A128GCM":case"A192GCM":case"A256GCM":return r instanceof Uint8Array&&K(r,parseInt(e.slice(1,4),10)),ew(e,t,r,i,n);default:throw new E("Unsupported JWE Content Encryption Algorithm")}};async function eg(e,t,r,i){let n=e.slice(0,7);i||(i=k(n));let{ciphertext:a,tag:s}=await eb(n,r,t,i,new Uint8Array(0));return{encryptedKey:a,iv:w(i),tag:w(s)}}async function em(e,t,r,i,n){let a=e.slice(0,7);return T(a,t,r,i,n,new Uint8Array(0))}async function ev(e,t,r,i,n){switch(ey(e,t,"decrypt"),e){case"dir":if(void 0!==r)throw new _("Encountered unexpected JWE Encrypted Key");return t;case"ECDH-ES":if(void 0!==r)throw new _("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let n,a;if(!M(i.epk))throw new _('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(!Y(t))throw new E("ECDH with the provided key is not allowed or not supported by your javascript runtime");let s=await ec(i.epk,e);if(void 0!==i.apu){if("string"!=typeof i.apu)throw new _('JOSE Header "apu" (Agreement PartyUInfo) invalid');n=g(i.apu)}if(void 0!==i.apv){if("string"!=typeof i.apv)throw new _('JOSE Header "apv" (Agreement PartyVInfo) invalid');a=g(i.apv)}let o=await V(s,t,"ECDH-ES"===e?i.enc:e,"ECDH-ES"===e?es(i.enc):parseInt(e.slice(-5,-2),10),n,a);if("ECDH-ES"===e)return o;if(void 0===r)throw new _("JWE Encrypted Key missing");return Z(e.slice(-6),o,r)}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===r)throw new _("JWE Encrypted Key missing");return ea(e,t,r);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(void 0===r)throw new _("JWE Encrypted Key missing");if("number"!=typeof i.p2c)throw new _('JOSE Header "p2c" (PBES2 Count) missing or invalid');let a=(null==n?void 0:n.maxPBES2Count)||1e4;if(i.p2c>a)throw new _('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof i.p2s)throw new _('JOSE Header "p2s" (PBES2 Salt) missing or invalid');return et(e,t,r,i.p2c,g(i.p2s))}case"A128KW":case"A192KW":case"A256KW":if(void 0===r)throw new _("JWE Encrypted Key missing");return Z(e,t,r);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(void 0===r)throw new _("JWE Encrypted Key missing");if("string"!=typeof i.iv)throw new _('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof i.tag)throw new _('JOSE Header "tag" (Authentication Tag) missing or invalid');let n=g(i.iv),a=g(i.tag);return em(e,t,r,n,a)}default:throw new E('Invalid or unsupported "alg" (JWE Algorithm) header value')}}var eE=function(e,t,r,i,n){let a;if(void 0!==n.crit&&void 0===i.crit)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||void 0===i.crit)return new Set;if(!Array.isArray(i.crit)||0===i.crit.length||i.crit.some(e=>"string"!=typeof e||0===e.length))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let s of(a=void 0!==r?new Map([...Object.entries(r),...t.entries()]):t,i.crit)){if(!a.has(s))throw new E(`Extension Header Parameter "${s}" is not recognized`);if(void 0===n[s])throw new e(`Extension Header Parameter "${s}" is missing`);if(a.get(s)&&void 0===i[s])throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(i.crit)};let eA=(e,t)=>{if(void 0!==t&&(!Array.isArray(t)||t.some(e=>"string"!=typeof e)))throw TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)};async function e_(e,t,r){var i;let n,a,s,u;if(!M(e))throw new _("Flattened JWE must be an object");if(void 0===e.protected&&void 0===e.header&&void 0===e.unprotected)throw new _("JOSE Header missing");if("string"!=typeof e.iv)throw new _("JWE Initialization Vector missing or incorrect type");if("string"!=typeof e.ciphertext)throw new _("JWE Ciphertext missing or incorrect type");if("string"!=typeof e.tag)throw new _("JWE Authentication Tag missing or incorrect type");if(void 0!==e.protected&&"string"!=typeof e.protected)throw new _("JWE Protected Header incorrect type");if(void 0!==e.encrypted_key&&"string"!=typeof e.encrypted_key)throw new _("JWE Encrypted Key incorrect type");if(void 0!==e.aad&&"string"!=typeof e.aad)throw new _("JWE AAD incorrect type");if(void 0!==e.header&&!M(e.header))throw new _("JWE Shared Unprotected Header incorrect type");if(void 0!==e.unprotected&&!M(e.unprotected))throw new _("JWE Per-Recipient Unprotected Header incorrect type");if(e.protected)try{let t=g(e.protected);n=JSON.parse(l.decode(t))}catch(e){throw new _("JWE Protected Header is invalid")}if(!$(n,e.header,e.unprotected))throw new _("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let c={...n,...e.header,...e.unprotected};if(eE(_,new Map,null==r?void 0:r.crit,n,c),void 0!==c.zip){if(!n||!n.zip)throw new _('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==c.zip)throw new E('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:f,enc:d}=c;if("string"!=typeof f||!f)throw new _("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof d||!d)throw new _("missing JWE Encryption Algorithm (enc) in JWE Header");let y=r&&eA("keyManagementAlgorithms",r.keyManagementAlgorithms),p=r&&eA("contentEncryptionAlgorithms",r.contentEncryptionAlgorithms);if(y&&!y.has(f))throw new v('"alg" (Algorithm) Header Parameter not allowed');if(p&&!p.has(d))throw new v('"enc" (Encryption Algorithm) Header Parameter not allowed');void 0!==e.encrypted_key&&(a=g(e.encrypted_key));let w=!1;"function"==typeof t&&(t=await t(n,e),w=!0);try{s=await ev(f,t,a,c,r)}catch(e){if(e instanceof TypeError||e instanceof _||e instanceof E)throw e;s=eo(d)}let b=g(e.iv),m=g(e.tag),A=o.encode(null!==(i=e.protected)&&void 0!==i?i:"");u=void 0!==e.aad?h(A,o.encode("."),o.encode(e.aad)):A;let S=await T(d,s,g(e.ciphertext),b,m,u);"DEF"===c.zip&&(S=await ((null==r?void 0:r.inflateRaw)||W)(S));let P={plaintext:S};return(void 0!==e.protected&&(P.protectedHeader=n),void 0!==e.aad&&(P.additionalAuthenticatedData=g(e.aad)),void 0!==e.unprotected&&(P.sharedUnprotectedHeader=e.unprotected),void 0!==e.header&&(P.unprotectedHeader=e.header),w)?{...P,key:t}:P}let eS=async e=>{if(e instanceof Uint8Array)return{kty:"oct",k:w(e)};if(!a(e))throw TypeError(C(e,...D,"Uint8Array"));if(!e.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:t,key_ops:r,alg:i,use:s,...o}=await n.subtle.exportKey("jwk",e);return o};async function eP(e){return eS(e)}async function ek(e,t,r,i,n={}){let a,s,o;switch(ey(e,r,"encrypt"),e){case"dir":o=r;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!Y(r))throw new E("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:l,apv:h}=n,{epk:u}=n;u||(u=(await X(r)).privateKey);let{x:c,y:f,crv:d,kty:y}=await eP(u),p=await V(r,u,"ECDH-ES"===e?t:e,"ECDH-ES"===e?es(t):parseInt(e.slice(-5,-2),10),l,h);if(s={epk:{x:c,crv:d,kty:y}},"EC"===y&&(s.epk.y=f),l&&(s.apu=w(l)),h&&(s.apv=w(h)),"ECDH-ES"===e){o=p;break}o=i||eo(t);let b=e.slice(-6);a=await J(b,p,o);break}case"RSA1_5":case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o=i||eo(t),a=await en(e,r,o);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{o=i||eo(t);let{p2c:l,p2s:h}=n;({encryptedKey:a,...s}=await ee(e,r,o,l,h));break}case"A128KW":case"A192KW":case"A256KW":o=i||eo(t),a=await J(e,r,o);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{o=i||eo(t);let{iv:l}=n;({encryptedKey:a,...s}=await eg(e,r,o,l));break}default:throw new E('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:o,encryptedKey:a,parameters:s}}let ex=Symbol();class eK{constructor(e){if(!(e instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this._plaintext=e}setKeyManagementParameters(e){if(this._keyManagementParameters)throw TypeError("setKeyManagementParameters can only be called once");return this._keyManagementParameters=e,this}setProtectedHeader(e){if(this._protectedHeader)throw TypeError("setProtectedHeader can only be called once");return this._protectedHeader=e,this}setSharedUnprotectedHeader(e){if(this._sharedUnprotectedHeader)throw TypeError("setSharedUnprotectedHeader can only be called once");return this._sharedUnprotectedHeader=e,this}setUnprotectedHeader(e){if(this._unprotectedHeader)throw TypeError("setUnprotectedHeader can only be called once");return this._unprotectedHeader=e,this}setAdditionalAuthenticatedData(e){return this._aad=e,this}setContentEncryptionKey(e){if(this._cek)throw TypeError("setContentEncryptionKey can only be called once");return this._cek=e,this}setInitializationVector(e){if(this._iv)throw TypeError("setInitializationVector can only be called once");return this._iv=e,this}async encrypt(e,t){let r,i,n,a,s,u,c;if(!this._protectedHeader&&!this._unprotectedHeader&&!this._sharedUnprotectedHeader)throw new _("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!$(this._protectedHeader,this._unprotectedHeader,this._sharedUnprotectedHeader))throw new _("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let f={...this._protectedHeader,...this._unprotectedHeader,...this._sharedUnprotectedHeader};if(eE(_,new Map,null==t?void 0:t.crit,this._protectedHeader,f),void 0!==f.zip){if(!this._protectedHeader||!this._protectedHeader.zip)throw new _('JWE "zip" (Compression Algorithm) Header MUST be integrity protected');if("DEF"!==f.zip)throw new E('Unsupported JWE "zip" (Compression Algorithm) Header Parameter value')}let{alg:d,enc:y}=f;if("string"!=typeof d||!d)throw new _('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof y||!y)throw new _('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if("dir"===d){if(this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Encryption")}else if("ECDH-ES"===d&&this._cek)throw TypeError("setContentEncryptionKey cannot be called when using Direct Key Agreement");{let n;({cek:i,encryptedKey:r,parameters:n}=await ek(d,y,e,this._cek,this._keyManagementParameters)),n&&(t&&ex in t?this._unprotectedHeader?this._unprotectedHeader={...this._unprotectedHeader,...n}:this.setUnprotectedHeader(n):this._protectedHeader?this._protectedHeader={...this._protectedHeader,...n}:this.setProtectedHeader(n))}if(this._iv||(this._iv=k(y)),a=this._protectedHeader?o.encode(w(JSON.stringify(this._protectedHeader))):o.encode(""),this._aad?(s=w(this._aad),n=h(a,o.encode("."),o.encode(s))):n=a,"DEF"===f.zip){let e=await ((null==t?void 0:t.deflateRaw)||N)(this._plaintext);({ciphertext:u,tag:c}=await eb(y,e,i,this._iv,n))}else({ciphertext:u,tag:c}=await eb(y,this._plaintext,i,this._iv,n));let p={ciphertext:w(u),iv:w(this._iv),tag:w(c)};return r&&(p.encrypted_key=w(r)),s&&(p.aad=s),this._protectedHeader&&(p.protected=l.decode(a)),this._sharedUnprotectedHeader&&(p.unprotected=this._sharedUnprotectedHeader),this._unprotectedHeader&&(p.header=this._unprotectedHeader),p}}let eH=w,eU=g;function eB(e){var t;let r=null!==(t=null==e?void 0:e.modulusLength)&&void 0!==t?t:2048;if("number"!=typeof r||r<2048)throw new E("Invalid or unsupported modulusLength option provided, 2048 bits or larger keys must be used");return r}async function eI(e,t){var r,i,a,s;let o,l;switch(e){case"PS256":case"PS384":case"PS512":o={name:"RSA-PSS",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eB(t)},l=["sign","verify"];break;case"RS256":case"RS384":case"RS512":o={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.slice(-3)}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eB(t)},l=["sign","verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":o={name:"RSA-OAEP",hash:`SHA-${parseInt(e.slice(-3),10)||1}`,publicExponent:new Uint8Array([1,0,1]),modulusLength:eB(t)},l=["decrypt","unwrapKey","encrypt","wrapKey"];break;case"ES256":o={name:"ECDSA",namedCurve:"P-256"},l=["sign","verify"];break;case"ES384":o={name:"ECDSA",namedCurve:"P-384"},l=["sign","verify"];break;case"ES512":o={name:"ECDSA",namedCurve:"P-521"},l=["sign","verify"];break;case"EdDSA":l=["sign","verify"];let h=null!==(r=null==t?void 0:t.crv)&&void 0!==r?r:"Ed25519";switch(h){case"Ed25519":case"Ed448":o={name:h};break;default:throw new E("Invalid or unsupported crv option provided")}break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{l=["deriveKey","deriveBits"];let e=null!==(i=null==t?void 0:t.crv)&&void 0!==i?i:"P-256";switch(e){case"P-256":case"P-384":case"P-521":o={name:"ECDH",namedCurve:e};break;case"X25519":case"X448":o={name:e};break;default:throw new E("Invalid or unsupported crv option provided, supported values are P-256, P-384, P-521, X25519, and X448")}break}default:throw new E('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}try{return await n.subtle.generateKey(o,null!==(a=null==t?void 0:t.extractable)&&void 0!==a&&a,l)}catch(e){if("Ed25519"===o.name&&(null==e?void 0:e.name)==="NotSupportedError"&&eh())return o={name:"NODE-ED25519",namedCurve:"NODE-ED25519"},await n.subtle.generateKey(o,null!==(s=null==t?void 0:t.extractable)&&void 0!==s&&s,l);throw e}}async function eO(e,t){return eI(e,t)}}}]);