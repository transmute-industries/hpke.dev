(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1862)}])},5926:function(e,r,t){"use strict";t.d(r,{$:function(){return c}});var a=t(5893),n=t(4438),s=t.n(n),l=t(1163);let c=()=>{let e=(0,l.useRouter)();return(0,a.jsxs)("div",{className:"mb-32 grid text-center lg:mb-0 lg:grid-cols-4 lg:text-left",children:[(0,a.jsxs)("a",{href:"https://datatracker.ietf.org/doc/rfc9180",className:"group rounded-lg border border-transparent px-5 py-4 transition-colors hover:border-gray-300 hover:bg-gray-100 hover:dark:border-neutral-700 hover:dark:bg-neutral-800/30",target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsxs)("h2",{className:"".concat(s().className," mb-3 text-2xl font-semibold"),children:["RFC9180"," ",(0,a.jsx)("span",{className:"inline-block transition-transform group-hover:translate-x-1 motion-reduce:transform-none",children:"->"})]}),(0,a.jsx)("p",{className:"".concat(s().className," m-0 max-w-[30ch] text-sm opacity-50"),children:"Read the RFC from CFRG."})]}),(0,a.jsxs)("a",{href:"https://www.iana.org/assignments/hpke/hpke.xhtml",className:"group rounded-lg border border-transparent px-5 py-4 transition-colors hover:border-gray-300 hover:bg-gray-100 hover:dark:border-neutral-700 hover:dark:bg-neutral-800/30",target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsxs)("h2",{className:"".concat(s().className," mb-3 text-2xl font-semibold"),children:["IANA HPKE "," ",(0,a.jsx)("span",{className:"inline-block transition-transform group-hover:translate-x-1 motion-reduce:transform-none",children:"->"})]}),(0,a.jsx)("p",{className:"".concat(s().className," m-0 max-w-[30ch] text-sm opacity-50"),children:"IANA registry for HPKE."})]}),(0,a.jsxs)("a",{href:"https://datatracker.ietf.org/doc/draft-ietf-cose-hpke/",className:"group rounded-lg border border-transparent px-5 py-4 transition-colors hover:border-gray-300 hover:bg-gray-100 hover:dark:border-neutral-700 hover:dark:bg-neutral-800/30 ",target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsxs)("h2",{className:"".concat(s().className," mb-3 text-2xl font-semibold"),children:["draft-ietf-cose-hpke"," ",(0,a.jsx)("span",{className:"inline-block transition-transform group-hover:translate-x-1 motion-reduce:transform-none",children:"->"})]}),(0,a.jsx)("p",{className:"".concat(s().className," m-0 max-w-[30ch] text-sm opacity-50"),children:"Read the draft from the COSE WG."})]}),(0,a.jsxs)("a",{onClick:()=>{e.push("/implementations")},className:"group rounded-lg border border-transparent px-5 py-4 transition-colors hover:border-gray-300 hover:bg-gray-100 hover:dark:border-neutral-700 hover:dark:bg-neutral-800/30 cursor-pointer",children:[(0,a.jsxs)("h2",{className:"".concat(s().className," mb-3 text-2xl font-semibold"),children:["Implementations"," ",(0,a.jsx)("span",{className:"inline-block transition-transform group-hover:translate-x-1 motion-reduce:transform-none",children:"->"})]}),(0,a.jsx)("p",{className:"".concat(s().className," m-0 max-w-[30ch] text-sm opacity-50"),children:"Find implementations."})]})]})}},1862:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return j}});var a=t(5893),n=t(3671),s=t(7294),l=t(5152),c=t.n(l);let i=c()(()=>Promise.all([t.e(281),t.e(608),t.e(551)]).then(t.bind(t,5551)),{loadableGenerated:{webpack:()=>[5551]},ssr:!1}),o=e=>{let{message:r,ciphertext:t,plaintext:n,alg:s,publicKeyJwk:l,privateKeyJwk:c}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-xl text-center",children:s}),(0,a.jsx)("pre",{className:"text-sm",children:JSON.stringify({...l,alg:s},null,2)}),(0,a.jsx)("p",{className:"text-center p-4",children:"⬇️"}),(0,a.jsx)(i,{value:JSON.stringify(t,null,2)}),(0,a.jsx)("p",{className:"text-center p-4",children:"⬇️"}),(0,a.jsx)("pre",{className:"text-sm",children:JSON.stringify({...c,alg:s},null,2)})]})},d="ECDH-ES+A128KW",m=async(e,r)=>{let t=JSON.parse(JSON.stringify(r)),{alg:a}=t,s=a.split("+").pop().replace("KW","GCM"),l=await new n.aL(e).setProtectedHeader({alg:a,enc:s}).encrypt(await n.nO(t));return l},p=async(e,r)=>{let t=JSON.parse(JSON.stringify(r)),{plaintext:a}=await n.TA(e,await n.nO(t));return new TextDecoder().decode(a)},u=e=>{let{publicKeyJwk:r,privateKeyJwk:t,message:n}=e,[l,c]=(0,s.useState)(null),[i,u]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{let e=new TextEncoder().encode(n),a=await m(e,{...r,alg:d}),s=await p(a,{...t,alg:d});u(a),c(s)})()},[r,t,n]),(0,a.jsx)(o,{alg:d,message:n,ciphertext:i,plaintext:l,publicKeyJwk:r,privateKeyJwk:t})};var x=t(2093);let h="APPLE-HPKE-v1",f={[h]:new x.vN({kem:x.q9.DhkemP256HkdfSha256,kdf:x.i5.HkdfSha256,aead:x.Hu.Aes128Gcm})},g=async(e,r)=>{let t=JSON.parse(JSON.stringify(r)),{alg:a}=t;delete t.alg;let s=await window.crypto.subtle.importKey("jwk",t,{name:"ECDH",namedCurve:t.crv},!0,[]),l=await f[a].createSenderContext({recipientPublicKey:s}),c=await l.seal(e),i=n.tH.encode(new Uint8Array(l.enc)),o=n.tH.encode(new Uint8Array(c));return{ciphertext:o,enc:i}},b=async(e,r)=>{let t=JSON.parse(JSON.stringify(r)),{alg:a}=t;delete t.alg;let s=await window.crypto.subtle.importKey("jwk",t,{name:"ECDH",namedCurve:t.crv},!0,["deriveBits"]),l=n.tH.decode(e.enc),c=await f[a].createRecipientContext({recipientKey:s,enc:l}),i=n.tH.decode(e.ciphertext),o=await c.open(i);return new TextDecoder().decode(o)},y=e=>{let{publicKeyJwk:r,privateKeyJwk:t,message:n}=e,[l,c]=(0,s.useState)(null),[i,d]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{let e=new TextEncoder().encode(n),a=await g(e,{...r,alg:h}),s=await b(a,{...t,alg:h});d(a),c(s)})()},[r,t,n]),(0,a.jsx)(o,{alg:h,message:n,ciphertext:i,plaintext:l,publicKeyJwk:r,privateKeyJwk:t})},w="It’s a dangerous business, Frodo, going out your door.",N=async()=>{let{publicKey:e,privateKey:r}=await n.Au("ECDH-ES+A128KW",{extractable:!0}),t=await n.d3(e),a=await n.d3(r);return{publicKeyJwk:{kty:t.kty,crv:t.crv,x:t.x,y:t.y},privateKeyJwk:{kty:a.kty,crv:a.crv,x:a.x,y:a.y,d:a.d}}},k=()=>{let[e,r]=(0,s.useState)(null),[t,n]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{let{publicKeyJwk:e,privateKeyJwk:t}=await N();r(e),n(t)})()},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"items-center justify-between",children:[(0,a.jsx)("pre",{children:JSON.stringify(w,null,2)}),(0,a.jsx)("p",{className:"text-center p-4",children:"⬇️"}),(0,a.jsx)("pre",{className:"text-sm mb-8",children:JSON.stringify(e,null,2)})]}),e&&(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)("div",{children:(0,a.jsx)(u,{publicKeyJwk:e,privateKeyJwk:t,message:w})}),(0,a.jsx)("div",{children:(0,a.jsx)(y,{publicKeyJwk:e,privateKeyJwk:t,message:w})})]}),(0,a.jsx)("p",{className:"text-center",children:"⬇️"}),(0,a.jsx)("pre",{className:"text-sm",children:JSON.stringify(w,null,2)})]})};var v=t(5926);function j(){return(0,a.jsxs)("main",{className:"flex min-h-screen flex-col items-center justify-between p-24",children:[(0,a.jsxs)("div",{className:"z-10 w-full max-w-5xl items-center justify-between font-mono text-sm lg:flex",children:[(0,a.jsx)("p",{className:"fixed left-0 top-0 flex w-full justify-center from-zinc-200 pb-6 pt-8 backdrop-blur-2xl lg:static lg:w-auto lg:rounded-xl lg:p-4",children:(0,a.jsx)("a",{href:"https://hpke.dev",target:"_blank",rel:"noopener noreferrer",children:"hpke.dev"})}),(0,a.jsx)("div",{className:"fixed bottom-0 left-0 flex h-48 w-full items-end justify-center bg-gradient-to-t from-white via-white dark:from-black dark:via-black lg:static lg:h-auto lg:w-auto lg:bg-none",children:(0,a.jsx)("a",{className:"pointer-events-none flex place-items-center gap-2 p-8 lg:pointer-events-auto lg:p-0",href:"https://github.com/transmute-industries/hpke.dev",target:"_blank",rel:"noopener noreferrer",children:"Source"})})]}),(0,a.jsx)(k,{}),(0,a.jsx)(v.$,{})]})}},5856:function(){}},function(e){e.O(0,[70,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);